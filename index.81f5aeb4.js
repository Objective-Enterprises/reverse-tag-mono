!function(){function t(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};const n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const i=Object.create(null);Object.keys(n).forEach((t=>{i[n[t]]=t}));const o={type:"error",data:"parser error"},r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,a=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};var c=({type:t,data:e},i,o)=>{return r&&e instanceof Blob?i?o(e):a(e,o):s&&(e instanceof ArrayBuffer||(c=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer instanceof ArrayBuffer))?i?o(e):a(new Blob([e]),o):o(n[t]+(e||""));var c};const l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<l.length;t++)u[l.charCodeAt(t)]=t;const h=t=>{let e,n,i,o,r,s=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const l=new ArrayBuffer(s),h=new Uint8Array(l);for(e=0;e<a;e+=4)n=u[t.charCodeAt(e)],i=u[t.charCodeAt(e+1)],o=u[t.charCodeAt(e+2)],r=u[t.charCodeAt(e+3)],h[c++]=n<<2|i>>4,h[c++]=(15&i)<<4|o>>2,h[c++]=(3&o)<<6|63&r;return l},f="function"==typeof ArrayBuffer,p=(t,e)=>{if(f){const n=h(t);return d(n,e)}return{base64:!0,data:t}},d=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;var y=(t,e)=>{if("string"!=typeof t)return{type:"message",data:d(t,e)};const n=t.charAt(0);if("b"===n)return{type:"message",data:p(t.substring(1),e)};return i[n]?t.length>1?{type:i[n],data:t.substring(1)}:{type:i[n]}:o};const g=String.fromCharCode(30),m=(t,e)=>{const n=t.length,i=new Array(n);let o=0;t.forEach(((t,r)=>{c(t,!1,(t=>{i[r]=t,++o===n&&e(i.join(g))}))}))},v=(t,e)=>{const n=t.split(g),i=[];for(let t=0;t<n.length;t++){const o=y(n[t],e);if(i.push(o),"error"===o.type)break}return i};function x(t){if(t)return function(t){for(var e in x.prototype)t[e]=x.prototype[e];return t}(t)}x.prototype.on=x.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},x.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},x.prototype.off=x.prototype.removeListener=x.prototype.removeAllListeners=x.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<i.length;o++)if((n=i[o])===e||n.fn===e){i.splice(o,1);break}return 0===i.length&&delete this._callbacks["$"+t],this},x.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(n){i=0;for(var o=(n=n.slice(0)).length;i<o;++i)n[i].apply(this,e)}return this},x.prototype.emitReserved=x.prototype.emit,x.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},x.prototype.hasListeners=function(t){return!!this.listeners(t).length};const b="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function w(t,...e){return e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})}const S=setTimeout,A=clearTimeout;function B(t,e){e.useNativeTimers?(t.setTimeoutFn=S.bind(b),t.clearTimeoutFn=A.bind(b)):(t.setTimeoutFn=setTimeout.bind(b),t.clearTimeoutFn=clearTimeout.bind(b))}class k extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class E extends x{onError(t,e,n){return super.emitReserved("error",new k(t,e,n)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=y(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}constructor(t){super(),this.writable=!1,B(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}}const C="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),P={};let _,I=0,R=0;function T(t){let e="";do{e=C[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function M(){const t=T(+new Date);return t!==_?(I=0,_=t):t+"."+T(I++)}for(;R<64;R++)P[C[R]]=R;function O(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function L(t){let e={},n=t.split("&");for(let t=0,i=n.length;t<i;t++){let i=n[t].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}let N=!1;try{N="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}const U=N;function j(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||U))return new XMLHttpRequest}catch(t){}if(!e)try{return new(b[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function D(){}const F=null!=new j({xdomain:!1}).responseType;class V extends x{create(){const t=w(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new j(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=V.requestsCount++,V.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=D,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete V.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}constructor(t,e){super(),B(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}}if(V.requestsCount=0,V.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",q);else if("function"==typeof addEventListener){addEventListener("onpagehide"in b?"pagehide":"unload",q,!1)}function q(){for(let t in V.requests)V.requests.hasOwnProperty(t)&&V.requests[t].abort()}const H="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),W=b.WebSocket||b.MozWebSocket;var $,z;$=function(t){var e,n,i=et(t),o=i[0],r=i[1],s=new J(function(t,e,n){return 3*(e+n)/4-n}(0,o,r)),a=0,c=r>0?o-4:o;for(n=0;n<c;n+=4)e=X[t.charCodeAt(n)]<<18|X[t.charCodeAt(n+1)]<<12|X[t.charCodeAt(n+2)]<<6|X[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===r&&(e=X[t.charCodeAt(n)]<<2|X[t.charCodeAt(n+1)]>>4,s[a++]=255&e);1===r&&(e=X[t.charCodeAt(n)]<<10|X[t.charCodeAt(n+1)]<<4|X[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},z=function(t){for(var e,n=t.length,i=n%3,o=[],r=16383,s=0,a=n-i;s<a;s+=r)o.push(nt(t,s,s+r>a?a:s+r));1===i?(e=t[n-1],o.push(K[e>>2]+K[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(K[e>>10]+K[e>>4&63]+K[e<<2&63]+"="));return o.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var G,Y,K=[],X=[],J="undefined"!=typeof Uint8Array?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Z=0,tt=Q.length;Z<tt;++Z)K[Z]=Q[Z],X[Q.charCodeAt(Z)]=Z;function et(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function nt(t,e,n){for(var i,o,r=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),r.push(K[(o=i)>>18&63]+K[o>>12&63]+K[o>>6&63]+K[63&o]);return r.join("")}X["-".charCodeAt(0)]=62,X["_".charCodeAt(0)]=63,G=function(t,e,n,i,o){var r,s,a=8*o-i-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?o-1:0,f=n?-1:1,p=t[e+h];for(h+=f,r=p&(1<<-u)-1,p>>=-u,u+=a;u>0;r=256*r+t[e+h],h+=f,u-=8);for(s=r&(1<<-u)-1,r>>=-u,u+=i;u>0;s=256*s+t[e+h],h+=f,u-=8);if(0===r)r=1-l;else{if(r===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,i),r-=l}return(p?-1:1)*s*Math.pow(2,r-i)},Y=function(t,e,n,i,o,r){var s,a,c,l=8*r-o-1,u=(1<<l)-1,h=u>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:r-1,d=i?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,l+=o;l>0;t[n+p]=255&s,p+=d,s/=256,l-=8);t[n+p-d]|=128*y};const it="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;const ot=2147483647;function rt(t){if(t>ot)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,st.prototype),e}function st(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return lt(t)}return at(t,e,n)}function at(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!st.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|pt(t,e);let i=rt(n);const o=i.write(t,e);o!==n&&(i=i.slice(0,o));return i}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Gt(t,Uint8Array)){const e=new Uint8Array(t);return ht(e.buffer,e.byteOffset,e.byteLength)}return ut(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Gt(t,ArrayBuffer)||t&&Gt(t.buffer,ArrayBuffer))return ht(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Gt(t,SharedArrayBuffer)||t&&Gt(t.buffer,SharedArrayBuffer)))return ht(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return st.from(i,e,n);const o=function(t){if(st.isBuffer(t)){const e=0|ft(t.length),n=rt(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||Yt(t.length)?rt(0):ut(t);if("Buffer"===t.type&&Array.isArray(t.data))return ut(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return st.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function ct(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function lt(t){return ct(t),rt(t<0?0:0|ft(t))}function ut(t){const e=t.length<0?0:0|ft(t.length),n=rt(e);for(let i=0;i<e;i+=1)n[i]=255&t[i];return n}function ht(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(i,st.prototype),i}function ft(t){if(t>=ot)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ot.toString(16)+" bytes");return 0|t}function pt(t,e){if(st.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Gt(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Wt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $t(t).length;default:if(o)return i?-1:Wt(t).length;e=(""+e).toLowerCase(),o=!0}}function dt(t,e,n){let i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Pt(this,e,n);case"utf8":case"utf-8":return Bt(this,e,n);case"ascii":return Et(this,e,n);case"latin1":case"binary":return Ct(this,e,n);case"base64":return At(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function yt(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function gt(t,e,n,i,o){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Yt(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=st.from(e,i)),st.isBuffer(e))return 0===e.length?-1:mt(t,e,n,i,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):mt(t,[e],n,i,o);throw new TypeError("val must be string, number or Buffer")}function mt(t,e,n,i,o){let r,s=1,a=t.length,c=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let i=-1;for(r=n;r<a;r++)if(l(t,r)===l(e,-1===i?0:r-i)){if(-1===i&&(i=r),r-i+1===c)return i*s}else-1!==i&&(r-=r-i),i=-1}else for(n+c>a&&(n=a-c),r=n;r>=0;r--){let n=!0;for(let i=0;i<c;i++)if(l(t,r+i)!==l(e,i)){n=!1;break}if(n)return r}return-1}function vt(t,e,n,i){n=Number(n)||0;const o=t.length-n;i?(i=Number(i))>o&&(i=o):i=o;const r=e.length;let s;for(i>r/2&&(i=r/2),s=0;s<i;++s){const i=parseInt(e.substr(2*s,2),16);if(Yt(i))return s;t[n+s]=i}return s}function xt(t,e,n,i){return zt(Wt(e,t.length-n),t,n,i)}function bt(t,e,n,i){return zt(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function wt(t,e,n,i){return zt($t(e),t,n,i)}function St(t,e,n,i){return zt(function(t,e){let n,i,o;const r=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),i=n>>8,o=n%256,r.push(o),r.push(i);return r}(e,t.length-n),t,n,i)}function At(t,e,n){return 0===e&&n===t.length?z(t):z(t.slice(e,n))}function Bt(t,e,n){n=Math.min(t.length,n);const i=[];let o=e;for(;o<n;){const e=t[o];let r=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,i,a,c;switch(s){case 1:e<128&&(r=e);break;case 2:n=t[o+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(r=c));break;case 3:n=t[o+1],i=t[o+2],128==(192&n)&&128==(192&i)&&(c=(15&e)<<12|(63&n)<<6|63&i,c>2047&&(c<55296||c>57343)&&(r=c));break;case 4:n=t[o+1],i=t[o+2],a=t[o+3],128==(192&n)&&128==(192&i)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&i)<<6|63&a,c>65535&&c<1114112&&(r=c))}}null===r?(r=65533,s=1):r>65535&&(r-=65536,i.push(r>>>10&1023|55296),r=56320|1023&r),i.push(r),o+=s}return function(t){const e=t.length;if(e<=kt)return String.fromCharCode.apply(String,t);let n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=kt));return n}(i)}st.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),st.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(st.prototype,"parent",{enumerable:!0,get:function(){if(st.isBuffer(this))return this.buffer}}),Object.defineProperty(st.prototype,"offset",{enumerable:!0,get:function(){if(st.isBuffer(this))return this.byteOffset}}),st.poolSize=8192,st.from=function(t,e,n){return at(t,e,n)},Object.setPrototypeOf(st.prototype,Uint8Array.prototype),Object.setPrototypeOf(st,Uint8Array),st.alloc=function(t,e,n){return function(t,e,n){return ct(t),t<=0?rt(t):void 0!==e?"string"==typeof n?rt(t).fill(e,n):rt(t).fill(e):rt(t)}(t,e,n)},st.allocUnsafe=function(t){return lt(t)},st.allocUnsafeSlow=function(t){return lt(t)},st.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==st.prototype},st.compare=function(t,e){if(Gt(t,Uint8Array)&&(t=st.from(t,t.offset,t.byteLength)),Gt(e,Uint8Array)&&(e=st.from(e,e.offset,e.byteLength)),!st.isBuffer(t)||!st.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,i=e.length;for(let o=0,r=Math.min(n,i);o<r;++o)if(t[o]!==e[o]){n=t[o],i=e[o];break}return n<i?-1:i<n?1:0},st.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},st.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return st.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const i=st.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(Gt(e,Uint8Array))o+e.length>i.length?(st.isBuffer(e)||(e=st.from(e)),e.copy(i,o)):Uint8Array.prototype.set.call(i,e,o);else{if(!st.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(i,o)}o+=e.length}return i},st.byteLength=pt,st.prototype._isBuffer=!0,st.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)yt(this,e,e+1);return this},st.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)yt(this,e,e+3),yt(this,e+1,e+2);return this},st.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)yt(this,e,e+7),yt(this,e+1,e+6),yt(this,e+2,e+5),yt(this,e+3,e+4);return this},st.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?Bt(this,0,t):dt.apply(this,arguments)},st.prototype.toLocaleString=st.prototype.toString,st.prototype.equals=function(t){if(!st.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===st.compare(this,t)},st.prototype.inspect=function(){let t="";return t=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(t+=" ... "),"<Buffer "+t+">"},it&&(st.prototype[it]=st.prototype.inspect),st.prototype.compare=function(t,e,n,i,o){if(Gt(t,Uint8Array)&&(t=st.from(t,t.offset,t.byteLength)),!st.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===o&&(o=this.length),e<0||n>t.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&e>=n)return 0;if(i>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let r=(o>>>=0)-(i>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(r,s),c=this.slice(i,o),l=t.slice(e,n);for(let t=0;t<a;++t)if(c[t]!==l[t]){r=c[t],s=l[t];break}return r<s?-1:s<r?1:0},st.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},st.prototype.indexOf=function(t,e,n){return gt(this,t,e,n,!0)},st.prototype.lastIndexOf=function(t,e,n){return gt(this,t,e,n,!1)},st.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let r=!1;for(;;)switch(i){case"hex":return vt(this,t,e,n);case"utf8":case"utf-8":return xt(this,t,e,n);case"ascii":case"latin1":case"binary":return bt(this,t,e,n);case"base64":return wt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return St(this,t,e,n);default:if(r)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),r=!0}},st.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const kt=4096;function Et(t,e,n){let i="";n=Math.min(t.length,n);for(let o=e;o<n;++o)i+=String.fromCharCode(127&t[o]);return i}function Ct(t,e,n){let i="";n=Math.min(t.length,n);for(let o=e;o<n;++o)i+=String.fromCharCode(t[o]);return i}function Pt(t,e,n){const i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);let o="";for(let i=e;i<n;++i)o+=Kt[t[i]];return o}function _t(t,e,n){const i=t.slice(e,n);let o="";for(let t=0;t<i.length-1;t+=2)o+=String.fromCharCode(i[t]+256*i[t+1]);return o}function It(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Rt(t,e,n,i,o,r){if(!st.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<r)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function Tt(t,e,n,i,o){Ft(e,i,o,t,n,7);let r=Number(e&BigInt(4294967295));t[n++]=r,r>>=8,t[n++]=r,r>>=8,t[n++]=r,r>>=8,t[n++]=r;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function Mt(t,e,n,i,o){Ft(e,i,o,t,n,7);let r=Number(e&BigInt(4294967295));t[n+7]=r,r>>=8,t[n+6]=r,r>>=8,t[n+5]=r,r>>=8,t[n+4]=r;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function Ot(t,e,n,i,o,r){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Lt(t,e,n,i,o){return e=+e,n>>>=0,o||Ot(t,0,n,4),Y(t,e,n,i,23,4),n+4}function Nt(t,e,n,i,o){return e=+e,n>>>=0,o||Ot(t,0,n,8),Y(t,e,n,i,52,8),n+8}st.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const i=this.subarray(t,e);return Object.setPrototypeOf(i,st.prototype),i},st.prototype.readUintLE=st.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||It(t,e,this.length);let i=this[t],o=1,r=0;for(;++r<e&&(o*=256);)i+=this[t+r]*o;return i},st.prototype.readUintBE=st.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||It(t,e,this.length);let i=this[t+--e],o=1;for(;e>0&&(o*=256);)i+=this[t+--e]*o;return i},st.prototype.readUint8=st.prototype.readUInt8=function(t,e){return t>>>=0,e||It(t,1,this.length),this[t]},st.prototype.readUint16LE=st.prototype.readUInt16LE=function(t,e){return t>>>=0,e||It(t,2,this.length),this[t]|this[t+1]<<8},st.prototype.readUint16BE=st.prototype.readUInt16BE=function(t,e){return t>>>=0,e||It(t,2,this.length),this[t]<<8|this[t+1]},st.prototype.readUint32LE=st.prototype.readUInt32LE=function(t,e){return t>>>=0,e||It(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},st.prototype.readUint32BE=st.prototype.readUInt32BE=function(t,e){return t>>>=0,e||It(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},st.prototype.readBigUInt64LE=Xt((function(t){Vt(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const i=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))})),st.prototype.readBigUInt64BE=Xt((function(t){Vt(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const i=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(i)<<BigInt(32))+BigInt(o)})),st.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||It(t,e,this.length);let i=this[t],o=1,r=0;for(;++r<e&&(o*=256);)i+=this[t+r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},st.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||It(t,e,this.length);let i=e,o=1,r=this[t+--i];for(;i>0&&(o*=256);)r+=this[t+--i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},st.prototype.readInt8=function(t,e){return t>>>=0,e||It(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},st.prototype.readInt16LE=function(t,e){t>>>=0,e||It(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},st.prototype.readInt16BE=function(t,e){t>>>=0,e||It(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},st.prototype.readInt32LE=function(t,e){return t>>>=0,e||It(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},st.prototype.readInt32BE=function(t,e){return t>>>=0,e||It(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},st.prototype.readBigInt64LE=Xt((function(t){Vt(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const i=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),st.prototype.readBigInt64BE=Xt((function(t){Vt(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const i=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(i)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),st.prototype.readFloatLE=function(t,e){return t>>>=0,e||It(t,4,this.length),G(this,t,!0,23,4)},st.prototype.readFloatBE=function(t,e){return t>>>=0,e||It(t,4,this.length),G(this,t,!1,23,4)},st.prototype.readDoubleLE=function(t,e){return t>>>=0,e||It(t,8,this.length),G(this,t,!0,52,8)},st.prototype.readDoubleBE=function(t,e){return t>>>=0,e||It(t,8,this.length),G(this,t,!1,52,8)},st.prototype.writeUintLE=st.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e>>>=0,n>>>=0,!i){Rt(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,r=0;for(this[e]=255&t;++r<n&&(o*=256);)this[e+r]=t/o&255;return e+n},st.prototype.writeUintBE=st.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e>>>=0,n>>>=0,!i){Rt(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,r=1;for(this[e+o]=255&t;--o>=0&&(r*=256);)this[e+o]=t/r&255;return e+n},st.prototype.writeUint8=st.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,1,255,0),this[e]=255&t,e+1},st.prototype.writeUint16LE=st.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},st.prototype.writeUint16BE=st.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},st.prototype.writeUint32LE=st.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},st.prototype.writeUint32BE=st.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},st.prototype.writeBigUInt64LE=Xt((function(t,e=0){return Tt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),st.prototype.writeBigUInt64BE=Xt((function(t,e=0){return Mt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),st.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*n-1);Rt(this,t,e,n,i-1,-i)}let o=0,r=1,s=0;for(this[e]=255&t;++o<n&&(r*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/r>>0)-s&255;return e+n},st.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e>>>=0,!i){const i=Math.pow(2,8*n-1);Rt(this,t,e,n,i-1,-i)}let o=n-1,r=1,s=0;for(this[e+o]=255&t;--o>=0&&(r*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/r>>0)-s&255;return e+n},st.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},st.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},st.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},st.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},st.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Rt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},st.prototype.writeBigInt64LE=Xt((function(t,e=0){return Tt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),st.prototype.writeBigInt64BE=Xt((function(t,e=0){return Mt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),st.prototype.writeFloatLE=function(t,e,n){return Lt(this,t,e,!0,n)},st.prototype.writeFloatBE=function(t,e,n){return Lt(this,t,e,!1,n)},st.prototype.writeDoubleLE=function(t,e,n){return Nt(this,t,e,!0,n)},st.prototype.writeDoubleBE=function(t,e,n){return Nt(this,t,e,!1,n)},st.prototype.copy=function(t,e,n,i){if(!st.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);const o=i-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,i):Uint8Array.prototype.set.call(t,this.subarray(n,i),e),o},st.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!st.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){const e=t.charCodeAt(0);("utf8"===i&&e<128||"latin1"===i)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const r=st.isBuffer(t)?t:st.from(t,i),s=r.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=r[o%s]}return this};const Ut={};function jt(t,e,n){Ut[t]=class extends n{get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}}}function Dt(t){let e="",n=t.length;const i="-"===t[0]?1:0;for(;n>=i+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function Ft(t,e,n,i,o,r){if(t>n||t<e){const i="bigint"==typeof e?"n":"";let o;throw o=r>3?0===e||e===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(r+1)}${i}`:`>= -(2${i} ** ${8*(r+1)-1}${i}) and < 2 ** ${8*(r+1)-1}${i}`:`>= ${e}${i} and <= ${n}${i}`,new Ut.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){Vt(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||qt(e,t.length-(n+1))}(i,o,r)}function Vt(t,e){if("number"!=typeof t)throw new Ut.ERR_INVALID_ARG_TYPE(e,"number",t)}function qt(t,e,n){if(Math.floor(t)!==t)throw Vt(t,n),new Ut.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new Ut.ERR_BUFFER_OUT_OF_BOUNDS;throw new Ut.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}jt("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),jt("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),jt("ERR_OUT_OF_RANGE",(function(t,e,n){let i=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=Dt(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=Dt(o)),o+="n"),i+=` It must be ${e}. Received ${o}`,i}),RangeError);const Ht=/[^+/0-9A-Za-z-_]/g;function Wt(t,e){let n;e=e||1/0;const i=t.length;let o=null;const r=[];for(let s=0;s<i;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&r.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&r.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&r.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&r.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;r.push(n)}else if(n<2048){if((e-=2)<0)break;r.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;r.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;r.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return r}function $t(t){return $(function(t){if((t=(t=t.split("=")[0]).trim().replace(Ht,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function zt(t,e,n,i){let o;for(o=0;o<i&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function Gt(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Yt(t){return t!=t}const Kt=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const i=16*n;for(let o=0;o<16;++o)e[i+o]=t[n]+t[o]}return e}();function Xt(t){return"undefined"==typeof BigInt?Jt:t}function Jt(){throw new Error("BigInt not supported")}const Qt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const Zt={websocket:class extends E{get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=Qt?{}:w(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Qt?new W(t,e,n):e?new W(t,e):new W(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],i=e===t.length-1;c(n,this.supportsBinary,(t=>{try{this.ws.send(t)}catch(t){}i&&H((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=M()),this.supportsBinary||(t.b64=1);const i=O(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}check(){return!!W}constructor(t){super(t),this.supportsBinary=!t.forceBase64}},polling:class extends E{get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){v(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,m(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=M()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const i=O(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(i.length?"?"+i:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new V(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=F&&!e}}},te=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ee=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function ne(t){const e=t,n=t.indexOf("["),i=t.indexOf("]");-1!=n&&-1!=i&&(t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length));let o=te.exec(t||""),r={},s=14;for(;s--;)r[ee[s]]=o[s]||"";return-1!=n&&-1!=i&&(r.source=e,r.host=r.host.substring(1,r.host.length-1).replace(/;/g,":"),r.authority=r.authority.replace("[","").replace("]","").replace(/;/g,":"),r.ipv6uri=!0),r.pathNames=function(t,e){const n=/\/{2,9}/g,i=e.replace(n,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||i.splice(0,1);"/"==e.substr(e.length-1,1)&&i.splice(i.length-1,1);return i}(0,r.path),r.queryKey=function(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,i){e&&(n[e]=i)})),n}(0,r.query),r}class ie extends x{createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Zt[t](n)}open(){let t;if(this.opts.rememberUpgrade&&ie.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t),n=!1;ie.priorWebsocketSuccess=!1;const i=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ie.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function o(){n||(n=!0,l(),e.close(),e=null)}const r=t=>{const n=new Error("probe error: "+t);n.transport=e.name,o(),this.emitReserved("upgradeError",n)};function s(){r("transport closed")}function a(){r("socket closed")}function c(t){e&&t.name!==e.name&&o()}const l=()=>{e.removeListener("open",i),e.removeListener("error",r),e.removeListener("close",s),this.off("close",a),this.off("upgrading",c)};e.once("open",i),e.once("error",r),e.once("close",s),this.once("close",a),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",ie.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const i=this.writeBuffer[n].data;if(i&&(t+="string"==typeof(e=i)?function(t){let e=0,n=0;for(let i=0,o=t.length;i<o;i++)e=t.charCodeAt(i),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}var e;return this.writeBuffer}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,i){if("function"==typeof e&&(i=e,e=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const o={type:t,data:e,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){ie.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const i=t.length;for(;n<i;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=ne(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=ne(e.host).host),B(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=L(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}}ie.protocol=4;ie.protocol;function oe(t,e="",n){let i=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),i=ne(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const o=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+o+":"+i.port+e,i.href=i.protocol+"://"+o+(n&&n.port===i.port?"":":"+i.port),i}var re={};t(re,"protocol",(function(){return ge})),t(re,"PacketType",(function(){return me})),t(re,"Encoder",(function(){return xe})),t(re,"Decoder",(function(){return be}));const se="function"==typeof ArrayBuffer,ae=Object.prototype.toString,ce="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===ae.call(Blob),le="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===ae.call(File);function ue(t){return se&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||ce&&t instanceof Blob||le&&t instanceof File}function he(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(he(t[e]))return!0;return!1}if(ue(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return he(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&he(t[e]))return!0;return!1}function fe(t){const e=[],n=t.data,i=t;return i.data=pe(n,e),i.attachments=e.length,{packet:i,buffers:e}}function pe(t,e){if(!t)return t;if(ue(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let i=0;i<t.length;i++)n[i]=pe(t[i],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=pe(t[i],e));return n}return t}function de(t,e){return t.data=ye(t.data,e),t.attachments=void 0,t}function ye(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=ye(t[n],e);else if("object"==typeof t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=ye(t[n],e));return t}const ge=5;var me,ve;(ve=me||(me={}))[ve.CONNECT=0]="CONNECT",ve[ve.DISCONNECT=1]="DISCONNECT",ve[ve.EVENT=2]="EVENT",ve[ve.ACK=3]="ACK",ve[ve.CONNECT_ERROR=4]="CONNECT_ERROR",ve[ve.BINARY_EVENT=5]="BINARY_EVENT",ve[ve.BINARY_ACK=6]="BINARY_ACK";class xe{encode(t){return t.type!==me.EVENT&&t.type!==me.ACK||!he(t)?[this.encodeAsString(t)]:(t.type=t.type===me.EVENT?me.BINARY_EVENT:me.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==me.BINARY_EVENT&&t.type!==me.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=fe(t),n=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(n),i}constructor(t){this.replacer=t}}class be extends x{add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===me.BINARY_EVENT||e.type===me.BINARY_ACK?(this.reconstructor=new we(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!ue(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===me[n.type])throw new Error("unknown packet type "+n.type);if(n.type===me.BINARY_EVENT||n.type===me.BINARY_ACK){const i=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const o=t.substring(i,e);if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===t.charAt(e+1)){const i=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}n.nsp=t.substring(i,e)}else n.nsp="/";const i=t.charAt(e+1);if(""!==i&&Number(i)==i){const i=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(i,e+1))}if(t.charAt(++e)){const i=this.tryParse(t.substr(e));if(!be.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case me.CONNECT:return"object"==typeof e;case me.DISCONNECT:return void 0===e;case me.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case me.EVENT:case me.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case me.ACK:case me.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}constructor(t){super(),this.reviver=t}}class we{takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=de(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}}function Se(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Ae=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Be extends x{get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Se(t,"open",this.onopen.bind(this)),Se(t,"packet",this.onpacket.bind(this)),Se(t,"error",this.onerror.bind(this)),Se(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Ae.hasOwnProperty(t))throw new Error('"'+t+'" is a reserved event name');e.unshift(t);const n={type:me.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,i=e.pop();this._registerAckCallback(t,i),n.id=t}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const i=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(i),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this.packet({type:me.CONNECT,data:t})})):this.packet({type:me.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case me.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case me.EVENT:case me.BINARY_EVENT:this.onevent(t);break;case me.ACK:case me.BINARY_ACK:this.onack(t);break;case me.DISCONNECT:this.ondisconnect();break;case me.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...i){n||(n=!0,e.packet({type:me.ACK,id:t,data:i}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:me.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const n of e)n.apply(this,t.data)}}constructor(t,e,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}}function ke(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}ke.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},ke.prototype.reset=function(){this.attempts=0},ke.prototype.setMin=function(t){this.ms=t},ke.prototype.setMax=function(t){this.max=t},ke.prototype.setJitter=function(t){this.jitter=t};class Ee extends x{reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new ie(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=Se(e,"open",(function(){n.onopen(),t&&t()})),o=Se(e,"error",(e=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;0===t&&i();const n=this.setTimeoutFn((()=>{i(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(i),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Se(t,"ping",this.onping.bind(this)),Se(t,"data",this.ondata.bind(this)),Se(t,"error",this.onerror.bind(this)),Se(t,"close",this.onclose.bind(this)),Se(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){this.decoder.add(t)}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new Be(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){if(this.nsps[t].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,B(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new ke({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||re;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}}const Ce={};function Pe(t,e){"object"==typeof t&&(e=t,t=void 0);const n=oe(t,(e=e||{}).path||"/socket.io"),i=n.source,o=n.id,r=n.path,s=Ce[o]&&r in Ce[o].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||s?a=new Ee(i,e):(Ce[o]||(Ce[o]=new Ee(i,e)),a=Ce[o]),n.query&&!e.query&&(e.query=n.queryKey),a.socket(n.path,e)}function _e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.assign(Pe,{Manager:Ee,Socket:Be,io:Pe,connect:Pe});var Ie;
/*!
 * matter-js 0.18.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */Ie=function(){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=21)}([function(t,n){var i={};t.exports=i,function(){i._nextId=0,i._seed=0,i._nowStartTime=+new Date,i._warnedOnce={},i._decomp=null,i.extend=function(t,e){var n,o;"boolean"==typeof e?(n=2,o=e):(n=1,o=!0);for(var r=n;r<arguments.length;r++){var s=arguments[r];if(s)for(var a in s)o&&s[a]&&s[a].constructor===Object?t[a]&&t[a].constructor!==Object?t[a]=s[a]:(t[a]=t[a]||{},i.extend(t[a],o,s[a])):t[a]=s[a]}return t},i.clone=function(t,e){return i.extend({},e,t)},i.keys=function(t){if(Object.keys)return Object.keys(t);var e=[];for(var n in t)e.push(n);return e},i.values=function(t){var e=[];if(Object.keys){for(var n=Object.keys(t),i=0;i<n.length;i++)e.push(t[n[i]]);return e}for(var o in t)e.push(t[o]);return e},i.get=function(t,e,n,i){e=e.split(".").slice(n,i);for(var o=0;o<e.length;o+=1)t=t[e[o]];return t},i.set=function(t,e,n,o,r){var s=e.split(".").slice(o,r);return i.get(t,e,0,-1)[s[s.length-1]]=n,n},i.shuffle=function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(i.random()*(e+1)),o=t[e];t[e]=t[n],t[n]=o}return t},i.choose=function(t){return t[Math.floor(i.random()*t.length)]},i.isElement=function(t){return"undefined"!=typeof HTMLElement?t instanceof HTMLElement:!!(t&&t.nodeType&&t.nodeName)},i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isFunction=function(t){return"function"==typeof t},i.isPlainObject=function(t){return"object"==typeof t&&t.constructor===Object},i.isString=function(t){return"[object String]"===toString.call(t)},i.clamp=function(t,e,n){return t<e?e:t>n?n:t},i.sign=function(t){return t<0?-1:1},i.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-i._nowStartTime},i.random=function(e,n){return n=void 0!==n?n:1,(e=void 0!==e?e:0)+t()*(n-e)};var t=function(){return i._seed=(9301*i._seed+49297)%233280,i._seed/233280};i.colorToNumber=function(t){return 3==(t=t.replace("#","")).length&&(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)),parseInt(t,16)},i.logLevel=1,i.log=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.info=function(){console&&i.logLevel>0&&i.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warn=function(){console&&i.logLevel>0&&i.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},i.warnOnce=function(){var t=Array.prototype.slice.call(arguments).join(" ");i._warnedOnce[t]||(i.warn(t),i._warnedOnce[t]=!0)},i.deprecated=function(t,e,n){t[e]=i.chain((function(){i.warnOnce("🔅 deprecated 🔅",n)}),t[e])},i.nextId=function(){return i._nextId++},i.indexOf=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1},i.map=function(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n},i.topologicalSort=function(t){var e=[],n=[],o=[];for(var r in t)n[r]||o[r]||i._topologicalSort(r,n,o,t,e);return e},i._topologicalSort=function(t,e,n,o,r){var s=o[t]||[];n[t]=!0;for(var a=0;a<s.length;a+=1){var c=s[a];n[c]||e[c]||i._topologicalSort(c,e,n,o,r)}n[t]=!1,e[t]=!0,r.push(t)},i.chain=function(){for(var t=[],e=0;e<arguments.length;e+=1){var n=arguments[e];n._chained?t.push.apply(t,n._chained):t.push(n)}var i=function(){for(var e,n=new Array(arguments.length),i=0,o=arguments.length;i<o;i++)n[i]=arguments[i];for(i=0;i<t.length;i+=1){var r=t[i].apply(e,n);void 0!==r&&(e=r)}return e};return i._chained=t,i},i.chainPathBefore=function(t,e,n){return i.set(t,e,i.chain(n,i.get(t,e)))},i.chainPathAfter=function(t,e,n){return i.set(t,e,i.chain(i.get(t,e),n))},i.setDecomp=function(t){i._decomp=t},i.getDecomp=function(){var t=i._decomp;try{t||"undefined"==typeof window||(t=window.decomp),t||void 0===e||(t=e.decomp)}catch(e){t=null}return t}}()},function(t,e){var n={};t.exports=n,n.create=function(t){var e={min:{x:0,y:0},max:{x:0,y:0}};return t&&n.update(e,t),e},n.update=function(t,e,n){t.min.x=1/0,t.max.x=-1/0,t.min.y=1/0,t.max.y=-1/0;for(var i=0;i<e.length;i++){var o=e[i];o.x>t.max.x&&(t.max.x=o.x),o.x<t.min.x&&(t.min.x=o.x),o.y>t.max.y&&(t.max.y=o.y),o.y<t.min.y&&(t.min.y=o.y)}n&&(n.x>0?t.max.x+=n.x:t.min.x+=n.x,n.y>0?t.max.y+=n.y:t.min.y+=n.y)},n.contains=function(t,e){return e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y},n.overlaps=function(t,e){return t.min.x<=e.max.x&&t.max.x>=e.min.x&&t.max.y>=e.min.y&&t.min.y<=e.max.y},n.translate=function(t,e){t.min.x+=e.x,t.max.x+=e.x,t.min.y+=e.y,t.max.y+=e.y},n.shift=function(t,e){var n=t.max.x-t.min.x,i=t.max.y-t.min.y;t.min.x=e.x,t.max.x=e.x+n,t.min.y=e.y,t.max.y=e.y+i}},function(t,e){var n={};t.exports=n,n.create=function(t,e){return{x:t||0,y:e||0}},n.clone=function(t){return{x:t.x,y:t.y}},n.magnitude=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},n.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},n.rotate=function(t,e,n){var i=Math.cos(e),o=Math.sin(e);n||(n={});var r=t.x*i-t.y*o;return n.y=t.x*o+t.y*i,n.x=r,n},n.rotateAbout=function(t,e,n,i){var o=Math.cos(e),r=Math.sin(e);i||(i={});var s=n.x+((t.x-n.x)*o-(t.y-n.y)*r);return i.y=n.y+((t.x-n.x)*r+(t.y-n.y)*o),i.x=s,i},n.normalise=function(t){var e=n.magnitude(t);return 0===e?{x:0,y:0}:{x:t.x/e,y:t.y/e}},n.dot=function(t,e){return t.x*e.x+t.y*e.y},n.cross=function(t,e){return t.x*e.y-t.y*e.x},n.cross3=function(t,e,n){return(e.x-t.x)*(n.y-t.y)-(e.y-t.y)*(n.x-t.x)},n.add=function(t,e,n){return n||(n={}),n.x=t.x+e.x,n.y=t.y+e.y,n},n.sub=function(t,e,n){return n||(n={}),n.x=t.x-e.x,n.y=t.y-e.y,n},n.mult=function(t,e){return{x:t.x*e,y:t.y*e}},n.div=function(t,e){return{x:t.x/e,y:t.y/e}},n.perp=function(t,e){return{x:(e=!0===e?-1:1)*-t.y,y:e*t.x}},n.neg=function(t){return{x:-t.x,y:-t.y}},n.angle=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(t,e,n){var i={};t.exports=i;var o=n(2),r=n(0);i.create=function(t,e){for(var n=[],i=0;i<t.length;i++){var o=t[i],r={x:o.x,y:o.y,index:i,body:e,isInternal:!1};n.push(r)}return n},i.fromPath=function(t,e){var n=[];return t.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(t,e,i){n.push({x:parseFloat(e),y:parseFloat(i)})})),i.create(n,e)},i.centre=function(t){for(var e,n,r,s=i.area(t,!0),a={x:0,y:0},c=0;c<t.length;c++)r=(c+1)%t.length,e=o.cross(t[c],t[r]),n=o.mult(o.add(t[c],t[r]),e),a=o.add(a,n);return o.div(a,6*s)},i.mean=function(t){for(var e={x:0,y:0},n=0;n<t.length;n++)e.x+=t[n].x,e.y+=t[n].y;return o.div(e,t.length)},i.area=function(t,e){for(var n=0,i=t.length-1,o=0;o<t.length;o++)n+=(t[i].x-t[o].x)*(t[i].y+t[o].y),i=o;return e?n/2:Math.abs(n)/2},i.inertia=function(t,e){for(var n,i,r=0,s=0,a=t,c=0;c<a.length;c++)i=(c+1)%a.length,r+=(n=Math.abs(o.cross(a[i],a[c])))*(o.dot(a[i],a[i])+o.dot(a[i],a[c])+o.dot(a[c],a[c])),s+=n;return e/6*(r/s)},i.translate=function(t,e,n){n=void 0!==n?n:1;var i,o=t.length,r=e.x*n,s=e.y*n;for(i=0;i<o;i++)t[i].x+=r,t[i].y+=s;return t},i.rotate=function(t,e,n){if(0!==e){var i,o,r,s,a=Math.cos(e),c=Math.sin(e),l=n.x,u=n.y,h=t.length;for(s=0;s<h;s++)o=(i=t[s]).x-l,r=i.y-u,i.x=l+(o*a-r*c),i.y=u+(o*c+r*a);return t}},i.contains=function(t,e){for(var n,i=e.x,o=e.y,r=t.length,s=t[r-1],a=0;a<r;a++){if(n=t[a],(i-s.x)*(n.y-s.y)+(o-s.y)*(s.x-n.x)>0)return!1;s=n}return!0},i.scale=function(t,e,n,r){if(1===e&&1===n)return t;var s,a;r=r||i.centre(t);for(var c=0;c<t.length;c++)s=t[c],a=o.sub(s,r),t[c].x=r.x+a.x*e,t[c].y=r.y+a.y*n;return t},i.chamfer=function(t,e,n,i,s){e="number"==typeof e?[e]:e||[8],n=void 0!==n?n:-1,i=i||2,s=s||14;for(var a=[],c=0;c<t.length;c++){var l=t[c-1>=0?c-1:t.length-1],u=t[c],h=t[(c+1)%t.length],f=e[c<e.length?c:e.length-1];if(0!==f){var p=o.normalise({x:u.y-l.y,y:l.x-u.x}),d=o.normalise({x:h.y-u.y,y:u.x-h.x}),y=Math.sqrt(2*Math.pow(f,2)),g=o.mult(r.clone(p),f),m=o.normalise(o.mult(o.add(p,d),.5)),v=o.sub(u,o.mult(m,y)),x=n;-1===n&&(x=1.75*Math.pow(f,.32)),(x=r.clamp(x,i,s))%2==1&&(x+=1);for(var b=Math.acos(o.dot(p,d))/x,w=0;w<x;w++)a.push(o.add(o.rotate(g,b*w),v))}else a.push(u)}return a},i.clockwiseSort=function(t){var e=i.mean(t);return t.sort((function(t,n){return o.angle(e,t)-o.angle(e,n)})),t},i.isConvex=function(t){var e,n,i,o,r=0,s=t.length;if(s<3)return null;for(e=0;e<s;e++)if(i=(e+2)%s,o=(t[n=(e+1)%s].x-t[e].x)*(t[i].y-t[n].y),(o-=(t[n].y-t[e].y)*(t[i].x-t[n].x))<0?r|=1:o>0&&(r|=2),3===r)return!1;return 0!==r||null},i.hull=function(t){var e,n,i=[],r=[];for((t=t.slice(0)).sort((function(t,e){var n=t.x-e.x;return 0!==n?n:t.y-e.y})),n=0;n<t.length;n+=1){for(e=t[n];r.length>=2&&o.cross3(r[r.length-2],r[r.length-1],e)<=0;)r.pop();r.push(e)}for(n=t.length-1;n>=0;n-=1){for(e=t[n];i.length>=2&&o.cross3(i[i.length-2],i[i.length-1],e)<=0;)i.pop();i.push(e)}return i.pop(),r.pop(),i.concat(r)}},function(t,e,n){var i={};t.exports=i;var o=n(0);i.on=function(t,e,n){for(var i,o=e.split(" "),r=0;r<o.length;r++)i=o[r],t.events=t.events||{},t.events[i]=t.events[i]||[],t.events[i].push(n);return n},i.off=function(t,e,n){if(e){"function"==typeof e&&(n=e,e=o.keys(t.events).join(" "));for(var i=e.split(" "),r=0;r<i.length;r++){var s=t.events[i[r]],a=[];if(n&&s)for(var c=0;c<s.length;c++)s[c]!==n&&a.push(s[c]);t.events[i[r]]=a}}else t.events={}},i.trigger=function(t,e,n){var i,r,s,a,c=t.events;if(c&&o.keys(c).length>0){n||(n={}),i=e.split(" ");for(var l=0;l<i.length;l++)if(s=c[r=i[l]]){(a=o.clone(n,!1)).name=r,a.source=t;for(var u=0;u<s.length;u++)s[u].apply(t,[a])}}}},function(t,e,n){var i={};t.exports=i;var o=n(4),r=n(0),s=n(1),a=n(6);i.create=function(t){return r.extend({id:r.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},t)},i.setModified=function(t,e,n,o){if(t.isModified=e,e&&t.cache&&(t.cache.allBodies=null,t.cache.allConstraints=null,t.cache.allComposites=null),n&&t.parent&&i.setModified(t.parent,e,n,o),o)for(var r=0;r<t.composites.length;r++){var s=t.composites[r];i.setModified(s,e,n,o)}},i.add=function(t,e){var n=[].concat(e);o.trigger(t,"beforeAdd",{object:e});for(var s=0;s<n.length;s++){var a=n[s];switch(a.type){case"body":if(a.parent!==a){r.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}i.addBody(t,a);break;case"constraint":i.addConstraint(t,a);break;case"composite":i.addComposite(t,a);break;case"mouseConstraint":i.addConstraint(t,a.constraint)}}return o.trigger(t,"afterAdd",{object:e}),t},i.remove=function(t,e,n){var r=[].concat(e);o.trigger(t,"beforeRemove",{object:e});for(var s=0;s<r.length;s++){var a=r[s];switch(a.type){case"body":i.removeBody(t,a,n);break;case"constraint":i.removeConstraint(t,a,n);break;case"composite":i.removeComposite(t,a,n);break;case"mouseConstraint":i.removeConstraint(t,a.constraint)}}return o.trigger(t,"afterRemove",{object:e}),t},i.addComposite=function(t,e){return t.composites.push(e),e.parent=t,i.setModified(t,!0,!0,!1),t},i.removeComposite=function(t,e,n){var o=r.indexOf(t.composites,e);if(-1!==o&&i.removeCompositeAt(t,o),n)for(var s=0;s<t.composites.length;s++)i.removeComposite(t.composites[s],e,!0);return t},i.removeCompositeAt=function(t,e){return t.composites.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addBody=function(t,e){return t.bodies.push(e),i.setModified(t,!0,!0,!1),t},i.removeBody=function(t,e,n){var o=r.indexOf(t.bodies,e);if(-1!==o&&i.removeBodyAt(t,o),n)for(var s=0;s<t.composites.length;s++)i.removeBody(t.composites[s],e,!0);return t},i.removeBodyAt=function(t,e){return t.bodies.splice(e,1),i.setModified(t,!0,!0,!1),t},i.addConstraint=function(t,e){return t.constraints.push(e),i.setModified(t,!0,!0,!1),t},i.removeConstraint=function(t,e,n){var o=r.indexOf(t.constraints,e);if(-1!==o&&i.removeConstraintAt(t,o),n)for(var s=0;s<t.composites.length;s++)i.removeConstraint(t.composites[s],e,!0);return t},i.removeConstraintAt=function(t,e){return t.constraints.splice(e,1),i.setModified(t,!0,!0,!1),t},i.clear=function(t,e,n){if(n)for(var o=0;o<t.composites.length;o++)i.clear(t.composites[o],e,!0);return e?t.bodies=t.bodies.filter((function(t){return t.isStatic})):t.bodies.length=0,t.constraints.length=0,t.composites.length=0,i.setModified(t,!0,!0,!1),t},i.allBodies=function(t){if(t.cache&&t.cache.allBodies)return t.cache.allBodies;for(var e=[].concat(t.bodies),n=0;n<t.composites.length;n++)e=e.concat(i.allBodies(t.composites[n]));return t.cache&&(t.cache.allBodies=e),e},i.allConstraints=function(t){if(t.cache&&t.cache.allConstraints)return t.cache.allConstraints;for(var e=[].concat(t.constraints),n=0;n<t.composites.length;n++)e=e.concat(i.allConstraints(t.composites[n]));return t.cache&&(t.cache.allConstraints=e),e},i.allComposites=function(t){if(t.cache&&t.cache.allComposites)return t.cache.allComposites;for(var e=[].concat(t.composites),n=0;n<t.composites.length;n++)e=e.concat(i.allComposites(t.composites[n]));return t.cache&&(t.cache.allComposites=e),e},i.get=function(t,e,n){var o,r;switch(n){case"body":o=i.allBodies(t);break;case"constraint":o=i.allConstraints(t);break;case"composite":o=i.allComposites(t).concat(t)}return o?0===(r=o.filter((function(t){return t.id.toString()===e.toString()}))).length?null:r[0]:null},i.move=function(t,e,n){return i.remove(t,e),i.add(n,e),t},i.rebase=function(t){for(var e=i.allBodies(t).concat(i.allConstraints(t)).concat(i.allComposites(t)),n=0;n<e.length;n++)e[n].id=r.nextId();return t},i.translate=function(t,e,n){for(var o=n?i.allBodies(t):t.bodies,r=0;r<o.length;r++)a.translate(o[r],e);return t},i.rotate=function(t,e,n,o){for(var r=Math.cos(e),s=Math.sin(e),c=o?i.allBodies(t):t.bodies,l=0;l<c.length;l++){var u=c[l],h=u.position.x-n.x,f=u.position.y-n.y;a.setPosition(u,{x:n.x+(h*r-f*s),y:n.y+(h*s+f*r)}),a.rotate(u,e)}return t},i.scale=function(t,e,n,o,r){for(var s=r?i.allBodies(t):t.bodies,c=0;c<s.length;c++){var l=s[c],u=l.position.x-o.x,h=l.position.y-o.y;a.setPosition(l,{x:o.x+u*e,y:o.y+h*n}),a.scale(l,e,n)}return t},i.bounds=function(t){for(var e=i.allBodies(t),n=[],o=0;o<e.length;o+=1){var r=e[o];n.push(r.bounds.min,r.bounds.max)}return s.create(n)}},function(t,e,n){var i={};t.exports=i;var o=n(3),r=n(2),s=n(7),a=(n(16),n(0)),c=n(1),l=n(11);!function(){i._inertiaScale=4,i._nextCollidingGroupId=1,i._nextNonCollidingGroupId=-1,i._nextCategory=1,i.create=function(e){var n={id:a.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},i=a.extend(n,e);return t(i,e),i},i.nextGroup=function(t){return t?i._nextNonCollidingGroupId--:i._nextCollidingGroupId++},i.nextCategory=function(){return i._nextCategory=i._nextCategory<<1,i._nextCategory};var t=function(t,e){e=e||{},i.set(t,{bounds:t.bounds||c.create(t.vertices),positionPrev:t.positionPrev||r.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),o.rotate(t.vertices,t.angle,t.position),l.rotate(t.axes,t.angle),c.update(t.bounds,t.vertices,t.velocity),i.set(t,{axes:e.axes||t.axes,area:e.area||t.area,mass:e.mass||t.mass,inertia:e.inertia||t.inertia});var n=t.isStatic?"#14151f":a.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),s=t.isStatic?"#555":"#ccc",u=t.isStatic&&null===t.render.fillStyle?1:0;t.render.fillStyle=t.render.fillStyle||n,t.render.strokeStyle=t.render.strokeStyle||s,t.render.lineWidth=t.render.lineWidth||u,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};i.set=function(t,e,n){var o;for(o in"string"==typeof e&&(o=e,(e={})[o]=n),e)if(Object.prototype.hasOwnProperty.call(e,o))switch(n=e[o],o){case"isStatic":i.setStatic(t,n);break;case"isSleeping":s.set(t,n);break;case"mass":i.setMass(t,n);break;case"density":i.setDensity(t,n);break;case"inertia":i.setInertia(t,n);break;case"vertices":i.setVertices(t,n);break;case"position":i.setPosition(t,n);break;case"angle":i.setAngle(t,n);break;case"velocity":i.setVelocity(t,n);break;case"angularVelocity":i.setAngularVelocity(t,n);break;case"parts":i.setParts(t,n);break;case"centre":i.setCentre(t,n);break;default:t[o]=n}},i.setStatic=function(t,e){for(var n=0;n<t.parts.length;n++){var i=t.parts[n];i.isStatic=e,e?(i._original={restitution:i.restitution,friction:i.friction,mass:i.mass,inertia:i.inertia,density:i.density,inverseMass:i.inverseMass,inverseInertia:i.inverseInertia},i.restitution=0,i.friction=1,i.mass=i.inertia=i.density=1/0,i.inverseMass=i.inverseInertia=0,i.positionPrev.x=i.position.x,i.positionPrev.y=i.position.y,i.anglePrev=i.angle,i.angularVelocity=0,i.speed=0,i.angularSpeed=0,i.motion=0):i._original&&(i.restitution=i._original.restitution,i.friction=i._original.friction,i.mass=i._original.mass,i.inertia=i._original.inertia,i.density=i._original.density,i.inverseMass=i._original.inverseMass,i.inverseInertia=i._original.inverseInertia,i._original=null)}},i.setMass=function(t,e){var n=t.inertia/(t.mass/6);t.inertia=n*(e/6),t.inverseInertia=1/t.inertia,t.mass=e,t.inverseMass=1/t.mass,t.density=t.mass/t.area},i.setDensity=function(t,e){i.setMass(t,e*t.area),t.density=e},i.setInertia=function(t,e){t.inertia=e,t.inverseInertia=1/t.inertia},i.setVertices=function(t,e){e[0].body===t?t.vertices=e:t.vertices=o.create(e,t),t.axes=l.fromVertices(t.vertices),t.area=o.area(t.vertices),i.setMass(t,t.density*t.area);var n=o.centre(t.vertices);o.translate(t.vertices,n,-1),i.setInertia(t,i._inertiaScale*o.inertia(t.vertices,t.mass)),o.translate(t.vertices,t.position),c.update(t.bounds,t.vertices,t.velocity)},i.setParts=function(t,e,n){var r;for(e=e.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,r=0;r<e.length;r++){var s=e[r];s!==t&&(s.parent=t,t.parts.push(s))}if(1!==t.parts.length){if(n=void 0===n||n){var a=[];for(r=0;r<e.length;r++)a=a.concat(e[r].vertices);o.clockwiseSort(a);var c=o.hull(a),l=o.centre(c);i.setVertices(t,c),o.translate(t.vertices,l)}var u=i._totalProperties(t);t.area=u.area,t.parent=t,t.position.x=u.centre.x,t.position.y=u.centre.y,t.positionPrev.x=u.centre.x,t.positionPrev.y=u.centre.y,i.setMass(t,u.mass),i.setInertia(t,u.inertia),i.setPosition(t,u.centre)}},i.setCentre=function(t,e,n){n?(t.positionPrev.x+=e.x,t.positionPrev.y+=e.y,t.position.x+=e.x,t.position.y+=e.y):(t.positionPrev.x=e.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=e.y-(t.position.y-t.positionPrev.y),t.position.x=e.x,t.position.y=e.y)},i.setPosition=function(t,e){var n=r.sub(e,t.position);t.positionPrev.x+=n.x,t.positionPrev.y+=n.y;for(var i=0;i<t.parts.length;i++){var s=t.parts[i];s.position.x+=n.x,s.position.y+=n.y,o.translate(s.vertices,n),c.update(s.bounds,s.vertices,t.velocity)}},i.setAngle=function(t,e){var n=e-t.angle;t.anglePrev+=n;for(var i=0;i<t.parts.length;i++){var s=t.parts[i];s.angle+=n,o.rotate(s.vertices,n,t.position),l.rotate(s.axes,n),c.update(s.bounds,s.vertices,t.velocity),i>0&&r.rotateAbout(s.position,n,t.position,s.position)}},i.setVelocity=function(t,e){t.positionPrev.x=t.position.x-e.x,t.positionPrev.y=t.position.y-e.y,t.velocity.x=e.x,t.velocity.y=e.y,t.speed=r.magnitude(t.velocity)},i.setAngularVelocity=function(t,e){t.anglePrev=t.angle-e,t.angularVelocity=e,t.angularSpeed=Math.abs(t.angularVelocity)},i.translate=function(t,e){i.setPosition(t,r.add(t.position,e))},i.rotate=function(t,e,n){if(n){var o=Math.cos(e),r=Math.sin(e),s=t.position.x-n.x,a=t.position.y-n.y;i.setPosition(t,{x:n.x+(s*o-a*r),y:n.y+(s*r+a*o)}),i.setAngle(t,t.angle+e)}else i.setAngle(t,t.angle+e)},i.scale=function(t,e,n,r){var s=0,a=0;r=r||t.position;for(var u=0;u<t.parts.length;u++){var h=t.parts[u];o.scale(h.vertices,e,n,r),h.axes=l.fromVertices(h.vertices),h.area=o.area(h.vertices),i.setMass(h,t.density*h.area),o.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),i.setInertia(h,i._inertiaScale*o.inertia(h.vertices,h.mass)),o.translate(h.vertices,{x:h.position.x,y:h.position.y}),u>0&&(s+=h.area,a+=h.inertia),h.position.x=r.x+(h.position.x-r.x)*e,h.position.y=r.y+(h.position.y-r.y)*n,c.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=s,t.isStatic||(i.setMass(t,t.density*s),i.setInertia(t,a))),t.circleRadius&&(e===n?t.circleRadius*=e:t.circleRadius=null)},i.update=function(t,e,n,i){var s=Math.pow(e*n*t.timeScale,2),a=1-t.frictionAir*n*t.timeScale,u=t.position.x-t.positionPrev.x,h=t.position.y-t.positionPrev.y;t.velocity.x=u*a*i+t.force.x/t.mass*s,t.velocity.y=h*a*i+t.force.y/t.mass*s,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*a*i+t.torque/t.inertia*s,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=r.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var f=0;f<t.parts.length;f++){var p=t.parts[f];o.translate(p.vertices,t.velocity),f>0&&(p.position.x+=t.velocity.x,p.position.y+=t.velocity.y),0!==t.angularVelocity&&(o.rotate(p.vertices,t.angularVelocity,t.position),l.rotate(p.axes,t.angularVelocity),f>0&&r.rotateAbout(p.position,t.angularVelocity,t.position,p.position)),c.update(p.bounds,p.vertices,t.velocity)}},i.applyForce=function(t,e,n){t.force.x+=n.x,t.force.y+=n.y;var i=e.x-t.position.x,o=e.y-t.position.y;t.torque+=i*n.y-o*n.x},i._totalProperties=function(t){for(var e={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===t.parts.length?0:1;n<t.parts.length;n++){var i=t.parts[n],o=i.mass!==1/0?i.mass:1;e.mass+=o,e.area+=i.area,e.inertia+=i.inertia,e.centre=r.add(e.centre,r.mult(i.position,o))}return e.centre=r.div(e.centre,e.mass),e}}()},function(t,e,n){var i={};t.exports=i;var o=n(4);i._motionWakeThreshold=.18,i._motionSleepThreshold=.08,i._minBias=.9,i.update=function(t,e){for(var n=e*e*e,o=0;o<t.length;o++){var r=t[o],s=r.speed*r.speed+r.angularSpeed*r.angularSpeed;if(0===r.force.x&&0===r.force.y){var a=Math.min(r.motion,s),c=Math.max(r.motion,s);r.motion=i._minBias*a+(1-i._minBias)*c,r.sleepThreshold>0&&r.motion<i._motionSleepThreshold*n?(r.sleepCounter+=1,r.sleepCounter>=r.sleepThreshold&&i.set(r,!0)):r.sleepCounter>0&&(r.sleepCounter-=1)}else i.set(r,!1)}},i.afterCollisions=function(t,e){for(var n=e*e*e,o=0;o<t.length;o++){var r=t[o];if(r.isActive){var s=r.collision,a=s.bodyA.parent,c=s.bodyB.parent;if(!(a.isSleeping&&c.isSleeping||a.isStatic||c.isStatic)&&(a.isSleeping||c.isSleeping)){var l=a.isSleeping&&!a.isStatic?a:c,u=l===a?c:a;!l.isStatic&&u.motion>i._motionWakeThreshold*n&&i.set(l,!1)}}}},i.set=function(t,e){var n=t.isSleeping;e?(t.isSleeping=!0,t.sleepCounter=t.sleepThreshold,t.positionImpulse.x=0,t.positionImpulse.y=0,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.anglePrev=t.angle,t.speed=0,t.angularSpeed=0,t.motion=0,n||o.trigger(t,"sleepStart")):(t.isSleeping=!1,t.sleepCounter=0,n&&o.trigger(t,"sleepEnd"))}},function(t,e,n){var i={};t.exports=i;var o,r,s,a=n(3),c=n(9);o=[],r={overlap:0,axis:null},s={overlap:0,axis:null},i.create=function(t,e){return{pair:null,collided:!1,bodyA:t,bodyB:e,parentA:t.parent,parentB:e.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},i.collides=function(t,e,n){if(i._overlapAxes(r,t.vertices,e.vertices,t.axes),r.overlap<=0)return null;if(i._overlapAxes(s,e.vertices,t.vertices,e.axes),s.overlap<=0)return null;var o,l,u=n&&n.table[c.id(t,e)];u?o=u.collision:((o=i.create(t,e)).collided=!0,o.bodyA=t.id<e.id?t:e,o.bodyB=t.id<e.id?e:t,o.parentA=o.bodyA.parent,o.parentB=o.bodyB.parent),t=o.bodyA,e=o.bodyB,l=r.overlap<s.overlap?r:s;var h=o.normal,f=o.supports,p=l.axis,d=p.x,y=p.y;d*(e.position.x-t.position.x)+y*(e.position.y-t.position.y)<0?(h.x=d,h.y=y):(h.x=-d,h.y=-y),o.tangent.x=-h.y,o.tangent.y=h.x,o.depth=l.overlap,o.penetration.x=h.x*o.depth,o.penetration.y=h.y*o.depth;var g=i._findSupports(t,e,h,1),m=0;if(a.contains(t.vertices,g[0])&&(f[m++]=g[0]),a.contains(t.vertices,g[1])&&(f[m++]=g[1]),m<2){var v=i._findSupports(e,t,h,-1);a.contains(e.vertices,v[0])&&(f[m++]=v[0]),m<2&&a.contains(e.vertices,v[1])&&(f[m++]=v[1])}return 0===m&&(f[m++]=g[0]),f.length=m,o},i._overlapAxes=function(t,e,n,i){var o,r,s,a,c,l,u=e.length,h=n.length,f=e[0].x,p=e[0].y,d=n[0].x,y=n[0].y,g=i.length,m=Number.MAX_VALUE,v=0;for(c=0;c<g;c++){var x=i[c],b=x.x,w=x.y,S=f*b+p*w,A=d*b+y*w,B=S,k=A;for(l=1;l<u;l+=1)(a=e[l].x*b+e[l].y*w)>B?B=a:a<S&&(S=a);for(l=1;l<h;l+=1)(a=n[l].x*b+n[l].y*w)>k?k=a:a<A&&(A=a);if((o=(r=B-A)<(s=k-S)?r:s)<m&&(m=o,v=c,o<=0))break}t.axis=i[v],t.overlap=m},i._projectToAxis=function(t,e,n){for(var i=e[0].x*n.x+e[0].y*n.y,o=i,r=1;r<e.length;r+=1){var s=e[r].x*n.x+e[r].y*n.y;s>o?o=s:s<i&&(i=s)}t.min=i,t.max=o},i._findSupports=function(t,e,n,i){var r,s,a,c,l,u=e.vertices,h=u.length,f=t.position.x,p=t.position.y,d=n.x*i,y=n.y*i,g=Number.MAX_VALUE;for(l=0;l<h;l+=1)(c=d*(f-(s=u[l]).x)+y*(p-s.y))<g&&(g=c,r=s);return g=d*(f-(a=u[(h+r.index-1)%h]).x)+y*(p-a.y),d*(f-(s=u[(r.index+1)%h]).x)+y*(p-s.y)<g?(o[0]=r,o[1]=s,o):(o[0]=r,o[1]=a,o)}},function(t,e,n){var i={};t.exports=i;var o=n(17);i.create=function(t,e){var n=t.bodyA,o=t.bodyB,r={id:i.id(n,o),bodyA:n,bodyB:o,collision:t,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||o.isSensor,timeCreated:e,timeUpdated:e,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return i.update(r,t,e),r},i.update=function(t,e,n){var i=t.contacts,r=e.supports,s=t.activeContacts,a=e.parentA,c=e.parentB,l=a.vertices.length;t.isActive=!0,t.timeUpdated=n,t.collision=e,t.separation=e.depth,t.inverseMass=a.inverseMass+c.inverseMass,t.friction=a.friction<c.friction?a.friction:c.friction,t.frictionStatic=a.frictionStatic>c.frictionStatic?a.frictionStatic:c.frictionStatic,t.restitution=a.restitution>c.restitution?a.restitution:c.restitution,t.slop=a.slop>c.slop?a.slop:c.slop,e.pair=t,s.length=0;for(var u=0;u<r.length;u++){var h=r[u],f=h.body===a?h.index:l+h.index,p=i[f];p?s.push(p):s.push(i[f]=o.create(h))}},i.setActive=function(t,e,n){e?(t.isActive=!0,t.timeUpdated=n):(t.isActive=!1,t.activeContacts.length=0)},i.id=function(t,e){return t.id<e.id?"A"+t.id+"B"+e.id:"A"+e.id+"B"+t.id}},function(t,e,n){var i={};t.exports=i;var o=n(3),r=n(2),s=n(7),a=n(1),c=n(11),l=n(0);i._warming=.4,i._torqueDampen=1,i._minLength=1e-6,i.create=function(t){var e=t;e.bodyA&&!e.pointA&&(e.pointA={x:0,y:0}),e.bodyB&&!e.pointB&&(e.pointB={x:0,y:0});var n=e.bodyA?r.add(e.bodyA.position,e.pointA):e.pointA,i=e.bodyB?r.add(e.bodyB.position,e.pointB):e.pointB,o=r.magnitude(r.sub(n,i));e.length=void 0!==e.length?e.length:o,e.id=e.id||l.nextId(),e.label=e.label||"Constraint",e.type="constraint",e.stiffness=e.stiffness||(e.length>0?1:.7),e.damping=e.damping||0,e.angularStiffness=e.angularStiffness||0,e.angleA=e.bodyA?e.bodyA.angle:e.angleA,e.angleB=e.bodyB?e.bodyB.angle:e.angleB,e.plugin={};var s={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===e.length&&e.stiffness>.1?(s.type="pin",s.anchors=!1):e.stiffness<.9&&(s.type="spring"),e.render=l.extend(s,e.render),e},i.preSolveAll=function(t){for(var e=0;e<t.length;e+=1){var n=t[e],i=n.constraintImpulse;n.isStatic||0===i.x&&0===i.y&&0===i.angle||(n.position.x+=i.x,n.position.y+=i.y,n.angle+=i.angle)}},i.solveAll=function(t,e){for(var n=0;n<t.length;n+=1){var o=t[n],r=!o.bodyA||o.bodyA&&o.bodyA.isStatic,s=!o.bodyB||o.bodyB&&o.bodyB.isStatic;(r||s)&&i.solve(t[n],e)}for(n=0;n<t.length;n+=1)r=!(o=t[n]).bodyA||o.bodyA&&o.bodyA.isStatic,s=!o.bodyB||o.bodyB&&o.bodyB.isStatic,r||s||i.solve(t[n],e)},i.solve=function(t,e){var n=t.bodyA,o=t.bodyB,s=t.pointA,a=t.pointB;if(n||o){n&&!n.isStatic&&(r.rotate(s,n.angle-t.angleA,s),t.angleA=n.angle),o&&!o.isStatic&&(r.rotate(a,o.angle-t.angleB,a),t.angleB=o.angle);var c=s,l=a;if(n&&(c=r.add(n.position,s)),o&&(l=r.add(o.position,a)),c&&l){var u=r.sub(c,l),h=r.magnitude(u);h<i._minLength&&(h=i._minLength);var f,p,d,y,g,m=(h-t.length)/h,v=t.stiffness<1?t.stiffness*e:t.stiffness,x=r.mult(u,m*v),b=(n?n.inverseMass:0)+(o?o.inverseMass:0),w=b+((n?n.inverseInertia:0)+(o?o.inverseInertia:0));if(t.damping){var S=r.create();d=r.div(u,h),g=r.sub(o&&r.sub(o.position,o.positionPrev)||S,n&&r.sub(n.position,n.positionPrev)||S),y=r.dot(d,g)}n&&!n.isStatic&&(p=n.inverseMass/b,n.constraintImpulse.x-=x.x*p,n.constraintImpulse.y-=x.y*p,n.position.x-=x.x*p,n.position.y-=x.y*p,t.damping&&(n.positionPrev.x-=t.damping*d.x*y*p,n.positionPrev.y-=t.damping*d.y*y*p),f=r.cross(s,x)/w*i._torqueDampen*n.inverseInertia*(1-t.angularStiffness),n.constraintImpulse.angle-=f,n.angle-=f),o&&!o.isStatic&&(p=o.inverseMass/b,o.constraintImpulse.x+=x.x*p,o.constraintImpulse.y+=x.y*p,o.position.x+=x.x*p,o.position.y+=x.y*p,t.damping&&(o.positionPrev.x+=t.damping*d.x*y*p,o.positionPrev.y+=t.damping*d.y*y*p),f=r.cross(a,x)/w*i._torqueDampen*o.inverseInertia*(1-t.angularStiffness),o.constraintImpulse.angle+=f,o.angle+=f)}}},i.postSolveAll=function(t){for(var e=0;e<t.length;e++){var n=t[e],l=n.constraintImpulse;if(!(n.isStatic||0===l.x&&0===l.y&&0===l.angle)){s.set(n,!1);for(var u=0;u<n.parts.length;u++){var h=n.parts[u];o.translate(h.vertices,l),u>0&&(h.position.x+=l.x,h.position.y+=l.y),0!==l.angle&&(o.rotate(h.vertices,l.angle,n.position),c.rotate(h.axes,l.angle),u>0&&r.rotateAbout(h.position,l.angle,n.position,h.position)),a.update(h.bounds,h.vertices,n.velocity)}l.angle*=i._warming,l.x*=i._warming,l.y*=i._warming}}},i.pointAWorld=function(t){return{x:(t.bodyA?t.bodyA.position.x:0)+t.pointA.x,y:(t.bodyA?t.bodyA.position.y:0)+t.pointA.y}},i.pointBWorld=function(t){return{x:(t.bodyB?t.bodyB.position.x:0)+t.pointB.x,y:(t.bodyB?t.bodyB.position.y:0)+t.pointB.y}}},function(t,e,n){var i={};t.exports=i;var o=n(2),r=n(0);i.fromVertices=function(t){for(var e={},n=0;n<t.length;n++){var i=(n+1)%t.length,s=o.normalise({x:t[i].y-t[n].y,y:t[n].x-t[i].x}),a=0===s.y?1/0:s.x/s.y;e[a=a.toFixed(3).toString()]=s}return r.values(e)},i.rotate=function(t,e){if(0!==e)for(var n=Math.cos(e),i=Math.sin(e),o=0;o<t.length;o++){var r,s=t[o];r=s.x*n-s.y*i,s.y=s.x*i+s.y*n,s.x=r}}},function(t,e,n){var i={};t.exports=i;var o=n(3),r=n(0),s=n(6),a=n(1),c=n(2);i.rectangle=function(t,e,n,i,a){a=a||{};var c={label:"Rectangle Body",position:{x:t,y:e},vertices:o.fromPath("L 0 0 L "+n+" 0 L "+n+" "+i+" L 0 "+i)};if(a.chamfer){var l=a.chamfer;c.vertices=o.chamfer(c.vertices,l.radius,l.quality,l.qualityMin,l.qualityMax),delete a.chamfer}return s.create(r.extend({},c,a))},i.trapezoid=function(t,e,n,i,a,c){c=c||{};var l,u=n*(a*=.5),h=u+(1-2*a)*n,f=h+u;l=a<.5?"L 0 0 L "+u+" "+-i+" L "+h+" "+-i+" L "+f+" 0":"L 0 0 L "+h+" "+-i+" L "+f+" 0";var p={label:"Trapezoid Body",position:{x:t,y:e},vertices:o.fromPath(l)};if(c.chamfer){var d=c.chamfer;p.vertices=o.chamfer(p.vertices,d.radius,d.quality,d.qualityMin,d.qualityMax),delete c.chamfer}return s.create(r.extend({},p,c))},i.circle=function(t,e,n,o,s){o=o||{};var a={label:"Circle Body",circleRadius:n};s=s||25;var c=Math.ceil(Math.max(10,Math.min(s,n)));return c%2==1&&(c+=1),i.polygon(t,e,c,n,r.extend({},a,o))},i.polygon=function(t,e,n,a,c){if(c=c||{},n<3)return i.circle(t,e,a,c);for(var l=2*Math.PI/n,u="",h=.5*l,f=0;f<n;f+=1){var p=h+f*l,d=Math.cos(p)*a,y=Math.sin(p)*a;u+="L "+d.toFixed(3)+" "+y.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:t,y:e},vertices:o.fromPath(u)};if(c.chamfer){var m=c.chamfer;g.vertices=o.chamfer(g.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete c.chamfer}return s.create(r.extend({},g,c))},i.fromVertices=function(t,e,n,i,l,u,h,f){var p,d,y,g,m,v,x,b,w,S,A=r.getDecomp();for(p=Boolean(A&&A.quickDecomp),i=i||{},y=[],l=void 0!==l&&l,u=void 0!==u?u:.01,h=void 0!==h?h:10,f=void 0!==f?f:.01,r.isArray(n[0])||(n=[n]),w=0;w<n.length;w+=1)if(m=n[w],!(g=o.isConvex(m))&&!p&&r.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),g||!p)m=g?o.clockwiseSort(m):o.hull(m),y.push({position:{x:t,y:e},vertices:m});else{var B=m.map((function(t){return[t.x,t.y]}));A.makeCCW(B),!1!==u&&A.removeCollinearPoints(B,u),!1!==f&&A.removeDuplicatePoints&&A.removeDuplicatePoints(B,f);var k=A.quickDecomp(B);for(v=0;v<k.length;v++){var E=k[v].map((function(t){return{x:t[0],y:t[1]}}));h>0&&o.area(E)<h||y.push({position:o.centre(E),vertices:E})}}for(v=0;v<y.length;v++)y[v]=s.create(r.extend(y[v],i));if(l)for(v=0;v<y.length;v++){var C=y[v];for(x=v+1;x<y.length;x++){var P=y[x];if(a.overlaps(C.bounds,P.bounds)){var _=C.vertices,I=P.vertices;for(b=0;b<C.vertices.length;b++)for(S=0;S<P.vertices.length;S++){var R=c.magnitudeSquared(c.sub(_[(b+1)%_.length],I[S])),T=c.magnitudeSquared(c.sub(_[b],I[(S+1)%I.length]));R<5&&T<5&&(_[b].isInternal=!0,I[S].isInternal=!0)}}}}return y.length>1?(d=s.create(r.extend({parts:y.slice(0)},i)),s.setPosition(d,{x:t,y:e}),d):y[0]}},function(t,e,n){var i={};t.exports=i;var o=n(0);i.create=function(t){var e={};return t||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),e.element=t||document.body,e.absolute={x:0,y:0},e.position={x:0,y:0},e.mousedownPosition={x:0,y:0},e.mouseupPosition={x:0,y:0},e.offset={x:0,y:0},e.scale={x:1,y:1},e.wheelDelta=0,e.button=-1,e.pixelRatio=parseInt(e.element.getAttribute("data-pixel-ratio"),10)||1,e.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},e.mousemove=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&(e.button=0,t.preventDefault()),e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.sourceEvents.mousemove=t},e.mousedown=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches?(e.button=0,t.preventDefault()):e.button=t.button,e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mousedownPosition.x=e.position.x,e.mousedownPosition.y=e.position.y,e.sourceEvents.mousedown=t},e.mouseup=function(t){var n=i._getRelativeMousePosition(t,e.element,e.pixelRatio);t.changedTouches&&t.preventDefault(),e.button=-1,e.absolute.x=n.x,e.absolute.y=n.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y,e.mouseupPosition.x=e.position.x,e.mouseupPosition.y=e.position.y,e.sourceEvents.mouseup=t},e.mousewheel=function(t){e.wheelDelta=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),t.preventDefault()},i.setElement(e,e.element),e},i.setElement=function(t,e){t.element=e,e.addEventListener("mousemove",t.mousemove),e.addEventListener("mousedown",t.mousedown),e.addEventListener("mouseup",t.mouseup),e.addEventListener("mousewheel",t.mousewheel),e.addEventListener("DOMMouseScroll",t.mousewheel),e.addEventListener("touchmove",t.mousemove),e.addEventListener("touchstart",t.mousedown),e.addEventListener("touchend",t.mouseup)},i.clearSourceEvents=function(t){t.sourceEvents.mousemove=null,t.sourceEvents.mousedown=null,t.sourceEvents.mouseup=null,t.sourceEvents.mousewheel=null,t.wheelDelta=0},i.setOffset=function(t,e){t.offset.x=e.x,t.offset.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},i.setScale=function(t,e){t.scale.x=e.x,t.scale.y=e.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y},i._getRelativeMousePosition=function(t,e,n){var i,o,r=e.getBoundingClientRect(),s=document.documentElement||document.body.parentNode||document.body,a=void 0!==window.pageXOffset?window.pageXOffset:s.scrollLeft,c=void 0!==window.pageYOffset?window.pageYOffset:s.scrollTop,l=t.changedTouches;return l?(i=l[0].pageX-r.left-a,o=l[0].pageY-r.top-c):(i=t.pageX-r.left-a,o=t.pageY-r.top-c),{x:i/(e.clientWidth/(e.width||e.clientWidth)*n),y:o/(e.clientHeight/(e.height||e.clientHeight)*n)}}},function(t,e,n){var i={};t.exports=i;var o=n(0),r=n(8);i.create=function(t){return o.extend({bodies:[],pairs:null},t)},i.setBodies=function(t,e){t.bodies=e.slice(0)},i.clear=function(t){t.bodies=[]},i.collisions=function(t){var e,n,o=[],s=t.pairs,a=t.bodies,c=a.length,l=i.canCollide,u=r.collides;for(a.sort(i._compareBoundsX),e=0;e<c;e++){var h=a[e],f=h.bounds,p=h.bounds.max.x,d=h.bounds.max.y,y=h.bounds.min.y,g=h.isStatic||h.isSleeping,m=h.parts.length,v=1===m;for(n=e+1;n<c;n++){var x=a[n];if((C=x.bounds).min.x>p)break;if(!(d<C.min.y||y>C.max.y)&&(!g||!x.isStatic&&!x.isSleeping)&&l(h.collisionFilter,x.collisionFilter)){var b=x.parts.length;if(v&&1===b)(k=u(h,x,s))&&o.push(k);else for(var w=b>1?1:0,S=m>1?1:0;S<m;S++)for(var A=h.parts[S],B=(f=A.bounds,w);B<b;B++){var k,E=x.parts[B],C=E.bounds;f.min.x>C.max.x||f.max.x<C.min.x||f.max.y<C.min.y||f.min.y>C.max.y||(k=u(A,E,s))&&o.push(k)}}}}return o},i.canCollide=function(t,e){return t.group===e.group&&0!==t.group?t.group>0:0!=(t.mask&e.category)&&0!=(e.mask&t.category)},i._compareBoundsX=function(t,e){return t.bounds.min.x-e.bounds.min.x}},function(t,e,n){var i={};t.exports=i;var o=n(0);i._registry={},i.register=function(t){if(i.isPlugin(t)||o.warn("Plugin.register:",i.toString(t),"does not implement all required fields."),t.name in i._registry){var e=i._registry[t.name],n=i.versionParse(t.version).number,r=i.versionParse(e.version).number;n>r?(o.warn("Plugin.register:",i.toString(e),"was upgraded to",i.toString(t)),i._registry[t.name]=t):n<r?o.warn("Plugin.register:",i.toString(e),"can not be downgraded to",i.toString(t)):t!==e&&o.warn("Plugin.register:",i.toString(t),"is already registered to different plugin object")}else i._registry[t.name]=t;return t},i.resolve=function(t){return i._registry[i.dependencyParse(t).name]},i.toString=function(t){return"string"==typeof t?t:(t.name||"anonymous")+"@"+(t.version||t.range||"0.0.0")},i.isPlugin=function(t){return t&&t.name&&t.version&&t.install},i.isUsed=function(t,e){return t.used.indexOf(e)>-1},i.isFor=function(t,e){var n=t.for&&i.dependencyParse(t.for);return!t.for||e.name===n.name&&i.versionSatisfies(e.version,n.range)},i.use=function(t,e){if(t.uses=(t.uses||[]).concat(e||[]),0!==t.uses.length){for(var n=i.dependencies(t),r=o.topologicalSort(n),s=[],a=0;a<r.length;a+=1)if(r[a]!==t.name){var c=i.resolve(r[a]);c?i.isUsed(t,c.name)||(i.isFor(c,t)||(o.warn("Plugin.use:",i.toString(c),"is for",c.for,"but installed on",i.toString(t)+"."),c._warned=!0),c.install?c.install(t):(o.warn("Plugin.use:",i.toString(c),"does not specify an install function."),c._warned=!0),c._warned?(s.push("🔶 "+i.toString(c)),delete c._warned):s.push("✅ "+i.toString(c)),t.used.push(c.name)):s.push("❌ "+r[a])}s.length>0&&o.info(s.join("  "))}else o.warn("Plugin.use:",i.toString(t),"does not specify any dependencies to install.")},i.dependencies=function(t,e){var n=i.dependencyParse(t),r=n.name;if(!(r in(e=e||{}))){t=i.resolve(t)||t,e[r]=o.map(t.uses||[],(function(e){i.isPlugin(e)&&i.register(e);var r=i.dependencyParse(e),s=i.resolve(e);return s&&!i.versionSatisfies(s.version,r.range)?(o.warn("Plugin.dependencies:",i.toString(s),"does not satisfy",i.toString(r),"used by",i.toString(n)+"."),s._warned=!0,t._warned=!0):s||(o.warn("Plugin.dependencies:",i.toString(e),"used by",i.toString(n),"could not be resolved."),t._warned=!0),r.name}));for(var s=0;s<e[r].length;s+=1)i.dependencies(e[r][s],e);return e}},i.dependencyParse=function(t){return o.isString(t)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(t)||o.warn("Plugin.dependencyParse:",t,"is not a valid dependency string."),{name:t.split("@")[0],range:t.split("@")[1]||"*"}):{name:t.name,range:t.range||t.version}},i.versionParse=function(t){var e=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;e.test(t)||o.warn("Plugin.versionParse:",t,"is not a valid version or range.");var n=e.exec(t),i=Number(n[4]),r=Number(n[5]),s=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:t,operator:n[1]||n[2]||"",major:i,minor:r,patch:s,parts:[i,r,s],prerelease:n[7],number:1e8*i+1e4*r+s}},i.versionSatisfies=function(t,e){e=e||"*";var n=i.versionParse(e),o=i.versionParse(t);if(n.isRange){if("*"===n.operator||"*"===t)return!0;if(">"===n.operator)return o.number>n.number;if(">="===n.operator)return o.number>=n.number;if("~"===n.operator)return o.major===n.major&&o.minor===n.minor&&o.patch>=n.patch;if("^"===n.operator)return n.major>0?o.major===n.major&&o.number>=n.number:n.minor>0?o.minor===n.minor&&o.patch>=n.patch:o.patch===n.patch}return t===e||"*"===t}},function(t,e,n){var i={};t.exports=i;var o=n(0),r=n(5),s=n(1),a=n(4),c=n(2),l=n(13);!function(){var t,e;"undefined"!=typeof window&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout((function(){t(o.now())}),1e3/60)},e=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),i._goodFps=30,i._goodDelta=1e3/60,i.create=function(t){var e={controller:i,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!t.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=o.extend(e,t);return n.canvas&&(n.canvas.width=n.options.width||n.canvas.width,n.canvas.height=n.options.height||n.canvas.height),n.mouse=t.mouse,n.engine=t.engine,n.canvas=n.canvas||h(n.options.width,n.options.height),n.context=n.canvas.getContext("2d"),n.textures={},n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.canvas.width,y:n.canvas.height}},n.options.showBroadphase=!1,1!==n.options.pixelRatio&&i.setPixelRatio(n,n.options.pixelRatio),o.isElement(n.element)?n.element.appendChild(n.canvas):n.canvas.parentNode||o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),n},i.run=function(e){!function o(r){e.frameRequestId=t(o),n(e,r),i.world(e,r),(e.options.showStats||e.options.showDebug)&&i.stats(e,e.context,r),(e.options.showPerformance||e.options.showDebug)&&i.performance(e,e.context,r)}()},i.stop=function(t){e(t.frameRequestId)},i.setPixelRatio=function(t,e){var n=t.options,i=t.canvas;"auto"===e&&(e=f(i)),n.pixelRatio=e,i.setAttribute("data-pixel-ratio",e),i.width=n.width*e,i.height=n.height*e,i.style.width=n.width+"px",i.style.height=n.height+"px"},i.lookAt=function(t,e,n,i){i=void 0===i||i,e=o.isArray(e)?e:[e],n=n||{x:0,y:0};for(var r={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},s=0;s<e.length;s+=1){var a=e[s],c=a.bounds?a.bounds.min:a.min||a.position||a,u=a.bounds?a.bounds.max:a.max||a.position||a;c&&u&&(c.x<r.min.x&&(r.min.x=c.x),u.x>r.max.x&&(r.max.x=u.x),c.y<r.min.y&&(r.min.y=c.y),u.y>r.max.y&&(r.max.y=u.y))}var h=r.max.x-r.min.x+2*n.x,f=r.max.y-r.min.y+2*n.y,p=t.canvas.height,d=t.canvas.width/p,y=h/f,g=1,m=1;y>d?m=y/d:g=d/y,t.options.hasBounds=!0,t.bounds.min.x=r.min.x,t.bounds.max.x=r.min.x+h*g,t.bounds.min.y=r.min.y,t.bounds.max.y=r.min.y+f*m,i&&(t.bounds.min.x+=.5*h-h*g*.5,t.bounds.max.x+=.5*h-h*g*.5,t.bounds.min.y+=.5*f-f*m*.5,t.bounds.max.y+=.5*f-f*m*.5),t.bounds.min.x-=n.x,t.bounds.max.x-=n.x,t.bounds.min.y-=n.y,t.bounds.max.y-=n.y,t.mouse&&(l.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.canvas.width,y:(t.bounds.max.y-t.bounds.min.y)/t.canvas.height}),l.setOffset(t.mouse,t.bounds.min))},i.startViewTransform=function(t){var e=t.bounds.max.x-t.bounds.min.x,n=t.bounds.max.y-t.bounds.min.y,i=e/t.options.width,o=n/t.options.height;t.context.setTransform(t.options.pixelRatio/i,0,0,t.options.pixelRatio/o,0,0),t.context.translate(-t.bounds.min.x,-t.bounds.min.y)},i.endViewTransform=function(t){t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0)},i.world=function(t,e){var n,u=o.now(),h=t.engine,f=h.world,p=t.canvas,y=t.context,g=t.options,m=t.timing,v=r.allBodies(f),x=r.allConstraints(f),b=g.wireframes?g.wireframeBackground:g.background,w=[],S=[],A={timestamp:h.timing.timestamp};if(a.trigger(t,"beforeRender",A),t.currentBackground!==b&&d(t,b),y.globalCompositeOperation="source-in",y.fillStyle="transparent",y.fillRect(0,0,p.width,p.height),y.globalCompositeOperation="source-over",g.hasBounds){for(n=0;n<v.length;n++){var B=v[n];s.overlaps(B.bounds,t.bounds)&&w.push(B)}for(n=0;n<x.length;n++){var k=x[n],E=k.bodyA,C=k.bodyB,P=k.pointA,_=k.pointB;E&&(P=c.add(E.position,k.pointA)),C&&(_=c.add(C.position,k.pointB)),P&&_&&(s.contains(t.bounds,P)||s.contains(t.bounds,_))&&S.push(k)}i.startViewTransform(t),t.mouse&&(l.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.options.width,y:(t.bounds.max.y-t.bounds.min.y)/t.options.height}),l.setOffset(t.mouse,t.bounds.min))}else S=x,w=v,1!==t.options.pixelRatio&&t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0);!g.wireframes||h.enableSleeping&&g.showSleeping?i.bodies(t,w,y):(g.showConvexHulls&&i.bodyConvexHulls(t,w,y),i.bodyWireframes(t,w,y)),g.showBounds&&i.bodyBounds(t,w,y),(g.showAxes||g.showAngleIndicator)&&i.bodyAxes(t,w,y),g.showPositions&&i.bodyPositions(t,w,y),g.showVelocity&&i.bodyVelocity(t,w,y),g.showIds&&i.bodyIds(t,w,y),g.showSeparations&&i.separations(t,h.pairs.list,y),g.showCollisions&&i.collisions(t,h.pairs.list,y),g.showVertexNumbers&&i.vertexNumbers(t,w,y),g.showMousePosition&&i.mousePosition(t,t.mouse,y),i.constraints(S,y),g.hasBounds&&i.endViewTransform(t),a.trigger(t,"afterRender",A),m.lastElapsed=o.now()-u},i.stats=function(t,e,n){for(var i=t.engine,o=i.world,s=r.allBodies(o),a=0,c=0,l=0;l<s.length;l+=1)a+=s[l].parts.length;var u={Part:a,Body:s.length,Cons:r.allConstraints(o).length,Comp:r.allComposites(o).length,Pair:i.pairs.list.length};for(var h in e.fillStyle="#0e0f19",e.fillRect(c,0,302.5,44),e.font="12px Arial",e.textBaseline="top",e.textAlign="right",u){var f=u[h];e.fillStyle="#aaa",e.fillText(h,c+55,8),e.fillStyle="#eee",e.fillText(f,c+55,26),c+=55}},i.performance=function(t,e){var n=t.engine,o=t.timing,r=o.deltaHistory,s=o.elapsedHistory,a=o.timestampElapsedHistory,c=o.engineDeltaHistory,l=o.engineElapsedHistory,h=n.timing.lastDelta,f=u(r),p=u(s),d=u(c),y=u(l),g=u(a)/f||0,m=1e3/f||0,v=60;e.fillStyle="#0e0f19",e.fillRect(0,50,370,34),i.status(e,10,69,v,4,r.length,Math.round(m)+" fps",m/i._goodFps,(function(t){return r[t]/f-1})),i.status(e,82,69,v,4,c.length,h.toFixed(2)+" dt",i._goodDelta/h,(function(t){return c[t]/d-1})),i.status(e,154,69,v,4,l.length,y.toFixed(2)+" ut",1-y/i._goodFps,(function(t){return l[t]/y-1})),i.status(e,226,69,v,4,s.length,p.toFixed(2)+" rt",1-p/i._goodFps,(function(t){return s[t]/p-1})),i.status(e,298,69,v,4,a.length,g.toFixed(2)+" x",g*g*g,(function(t){return(a[t]/r[t]/g||0)-1}))},i.status=function(t,e,n,i,r,s,a,c,l){t.strokeStyle="#888",t.fillStyle="#444",t.lineWidth=1,t.fillRect(e,n+7,i,1),t.beginPath(),t.moveTo(e,n+7-r*o.clamp(.4*l(0),-2,2));for(var u=0;u<i;u+=1)t.lineTo(e+u,n+7-(u<s?r*o.clamp(.4*l(u),-2,2):0));t.stroke(),t.fillStyle="hsl("+o.clamp(25+95*c,0,120)+",100%,60%)",t.fillRect(e,n-7,4,4),t.font="12px Arial",t.textBaseline="middle",t.textAlign="right",t.fillStyle="#eee",t.fillText(a,e+i,n-5)},i.constraints=function(t,e){for(var n=e,i=0;i<t.length;i++){var r=t[i];if(r.render.visible&&r.pointA&&r.pointB){var s,a,l=r.bodyA,u=r.bodyB;if(s=l?c.add(l.position,r.pointA):r.pointA,"pin"===r.render.type)n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath();else{if(a=u?c.add(u.position,r.pointB):r.pointB,n.beginPath(),n.moveTo(s.x,s.y),"spring"===r.render.type)for(var h,f=c.sub(a,s),p=c.perp(c.normalise(f)),d=Math.ceil(o.clamp(r.length/5,12,20)),y=1;y<d;y+=1)h=y%2==0?1:-1,n.lineTo(s.x+f.x*(y/d)+p.x*h*4,s.y+f.y*(y/d)+p.y*h*4);n.lineTo(a.x,a.y)}r.render.lineWidth&&(n.lineWidth=r.render.lineWidth,n.strokeStyle=r.render.strokeStyle,n.stroke()),r.render.anchors&&(n.fillStyle=r.render.strokeStyle,n.beginPath(),n.arc(s.x,s.y,3,0,2*Math.PI),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},i.bodies=function(t,e,n){var i,o,r,s,a=n,c=(t.engine,t.options),l=c.showInternalEdges||!c.wireframes;for(r=0;r<e.length;r++)if((i=e[r]).render.visible)for(s=i.parts.length>1?1:0;s<i.parts.length;s++)if((o=i.parts[s]).render.visible){if(c.showSleeping&&i.isSleeping?a.globalAlpha=.5*o.render.opacity:1!==o.render.opacity&&(a.globalAlpha=o.render.opacity),o.render.sprite&&o.render.sprite.texture&&!c.wireframes){var u=o.render.sprite,h=p(t,u.texture);a.translate(o.position.x,o.position.y),a.rotate(o.angle),a.drawImage(h,h.width*-u.xOffset*u.xScale,h.height*-u.yOffset*u.yScale,h.width*u.xScale,h.height*u.yScale),a.rotate(-o.angle),a.translate(-o.position.x,-o.position.y)}else{if(o.circleRadius)a.beginPath(),a.arc(o.position.x,o.position.y,o.circleRadius,0,2*Math.PI);else{a.beginPath(),a.moveTo(o.vertices[0].x,o.vertices[0].y);for(var f=1;f<o.vertices.length;f++)!o.vertices[f-1].isInternal||l?a.lineTo(o.vertices[f].x,o.vertices[f].y):a.moveTo(o.vertices[f].x,o.vertices[f].y),o.vertices[f].isInternal&&!l&&a.moveTo(o.vertices[(f+1)%o.vertices.length].x,o.vertices[(f+1)%o.vertices.length].y);a.lineTo(o.vertices[0].x,o.vertices[0].y),a.closePath()}c.wireframes?(a.lineWidth=1,a.strokeStyle="#bbb",a.stroke()):(a.fillStyle=o.render.fillStyle,o.render.lineWidth&&(a.lineWidth=o.render.lineWidth,a.strokeStyle=o.render.strokeStyle,a.stroke()),a.fill())}a.globalAlpha=1}},i.bodyWireframes=function(t,e,n){var i,o,r,s,a,c=n,l=t.options.showInternalEdges;for(c.beginPath(),r=0;r<e.length;r++)if((i=e[r]).render.visible)for(a=i.parts.length>1?1:0;a<i.parts.length;a++){for(o=i.parts[a],c.moveTo(o.vertices[0].x,o.vertices[0].y),s=1;s<o.vertices.length;s++)!o.vertices[s-1].isInternal||l?c.lineTo(o.vertices[s].x,o.vertices[s].y):c.moveTo(o.vertices[s].x,o.vertices[s].y),o.vertices[s].isInternal&&!l&&c.moveTo(o.vertices[(s+1)%o.vertices.length].x,o.vertices[(s+1)%o.vertices.length].y);c.lineTo(o.vertices[0].x,o.vertices[0].y)}c.lineWidth=1,c.strokeStyle="#bbb",c.stroke()},i.bodyConvexHulls=function(t,e,n){var i,o,r,s=n;for(s.beginPath(),o=0;o<e.length;o++)if((i=e[o]).render.visible&&1!==i.parts.length){for(s.moveTo(i.vertices[0].x,i.vertices[0].y),r=1;r<i.vertices.length;r++)s.lineTo(i.vertices[r].x,i.vertices[r].y);s.lineTo(i.vertices[0].x,i.vertices[0].y)}s.lineWidth=1,s.strokeStyle="rgba(255,255,255,0.2)",s.stroke()},i.vertexNumbers=function(t,e,n){var i,o,r,s=n;for(i=0;i<e.length;i++){var a=e[i].parts;for(r=a.length>1?1:0;r<a.length;r++){var c=a[r];for(o=0;o<c.vertices.length;o++)s.fillStyle="rgba(255,255,255,0.2)",s.fillText(i+"_"+o,c.position.x+.8*(c.vertices[o].x-c.position.x),c.position.y+.8*(c.vertices[o].y-c.position.y))}}},i.mousePosition=function(t,e,n){var i=n;i.fillStyle="rgba(255,255,255,0.8)",i.fillText(e.position.x+"  "+e.position.y,e.position.x+5,e.position.y-5)},i.bodyBounds=function(t,e,n){var i=n,o=(t.engine,t.options);i.beginPath();for(var r=0;r<e.length;r++)if(e[r].render.visible)for(var s=e[r].parts,a=s.length>1?1:0;a<s.length;a++){var c=s[a];i.rect(c.bounds.min.x,c.bounds.min.y,c.bounds.max.x-c.bounds.min.x,c.bounds.max.y-c.bounds.min.y)}o.wireframes?i.strokeStyle="rgba(255,255,255,0.08)":i.strokeStyle="rgba(0,0,0,0.1)",i.lineWidth=1,i.stroke()},i.bodyAxes=function(t,e,n){var i,o,r,s,a=n,c=(t.engine,t.options);for(a.beginPath(),o=0;o<e.length;o++){var l=e[o],u=l.parts;if(l.render.visible)if(c.showAxes)for(r=u.length>1?1:0;r<u.length;r++)for(i=u[r],s=0;s<i.axes.length;s++){var h=i.axes[s];a.moveTo(i.position.x,i.position.y),a.lineTo(i.position.x+20*h.x,i.position.y+20*h.y)}else for(r=u.length>1?1:0;r<u.length;r++)for(i=u[r],s=0;s<i.axes.length;s++)a.moveTo(i.position.x,i.position.y),a.lineTo((i.vertices[0].x+i.vertices[i.vertices.length-1].x)/2,(i.vertices[0].y+i.vertices[i.vertices.length-1].y)/2)}c.wireframes?(a.strokeStyle="indianred",a.lineWidth=1):(a.strokeStyle="rgba(255, 255, 255, 0.4)",a.globalCompositeOperation="overlay",a.lineWidth=2),a.stroke(),a.globalCompositeOperation="source-over"},i.bodyPositions=function(t,e,n){var i,o,r,s,a=n,c=(t.engine,t.options);for(a.beginPath(),r=0;r<e.length;r++)if((i=e[r]).render.visible)for(s=0;s<i.parts.length;s++)o=i.parts[s],a.arc(o.position.x,o.position.y,3,0,2*Math.PI,!1),a.closePath();for(c.wireframes?a.fillStyle="indianred":a.fillStyle="rgba(0,0,0,0.5)",a.fill(),a.beginPath(),r=0;r<e.length;r++)(i=e[r]).render.visible&&(a.arc(i.positionPrev.x,i.positionPrev.y,2,0,2*Math.PI,!1),a.closePath());a.fillStyle="rgba(255,165,0,0.8)",a.fill()},i.bodyVelocity=function(t,e,n){var i=n;i.beginPath();for(var o=0;o<e.length;o++){var r=e[o];r.render.visible&&(i.moveTo(r.position.x,r.position.y),i.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}i.lineWidth=3,i.strokeStyle="cornflowerblue",i.stroke()},i.bodyIds=function(t,e,n){var i,o,r=n;for(i=0;i<e.length;i++)if(e[i].render.visible){var s=e[i].parts;for(o=s.length>1?1:0;o<s.length;o++){var a=s[o];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(a.id,a.position.x+10,a.position.y-10)}}},i.collisions=function(t,e,n){var i,o,r,s,a=n,c=t.options;for(a.beginPath(),r=0;r<e.length;r++)if((i=e[r]).isActive)for(o=i.collision,s=0;s<i.activeContacts.length;s++){var l=i.activeContacts[s].vertex;a.rect(l.x-1.5,l.y-1.5,3.5,3.5)}for(c.wireframes?a.fillStyle="rgba(255,255,255,0.7)":a.fillStyle="orange",a.fill(),a.beginPath(),r=0;r<e.length;r++)if((i=e[r]).isActive&&(o=i.collision,i.activeContacts.length>0)){var u=i.activeContacts[0].vertex.x,h=i.activeContacts[0].vertex.y;2===i.activeContacts.length&&(u=(i.activeContacts[0].vertex.x+i.activeContacts[1].vertex.x)/2,h=(i.activeContacts[0].vertex.y+i.activeContacts[1].vertex.y)/2),o.bodyB===o.supports[0].body||!0===o.bodyA.isStatic?a.moveTo(u-8*o.normal.x,h-8*o.normal.y):a.moveTo(u+8*o.normal.x,h+8*o.normal.y),a.lineTo(u,h)}c.wireframes?a.strokeStyle="rgba(255,165,0,0.7)":a.strokeStyle="orange",a.lineWidth=1,a.stroke()},i.separations=function(t,e,n){var i,o,r,s,a,c=n,l=t.options;for(c.beginPath(),a=0;a<e.length;a++)if((i=e[a]).isActive){r=(o=i.collision).bodyA;var u=1;(s=o.bodyB).isStatic||r.isStatic||(u=.5),s.isStatic&&(u=0),c.moveTo(s.position.x,s.position.y),c.lineTo(s.position.x-o.penetration.x*u,s.position.y-o.penetration.y*u),u=1,s.isStatic||r.isStatic||(u=.5),r.isStatic&&(u=0),c.moveTo(r.position.x,r.position.y),c.lineTo(r.position.x+o.penetration.x*u,r.position.y+o.penetration.y*u)}l.wireframes?c.strokeStyle="rgba(255,165,0,0.5)":c.strokeStyle="orange",c.stroke()},i.inspector=function(t,e){t.engine;var n,i=t.selected,o=t.render,r=o.options;if(r.hasBounds){var s=o.bounds.max.x-o.bounds.min.x,a=o.bounds.max.y-o.bounds.min.y,c=s/o.options.width,l=a/o.options.height;e.scale(1/c,1/l),e.translate(-o.bounds.min.x,-o.bounds.min.y)}for(var u=0;u<i.length;u++){var h=i[u].data;switch(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.9)",e.setLineDash([1,2]),h.type){case"body":n=h.bounds,e.beginPath(),e.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),e.closePath(),e.stroke();break;case"constraint":var f=h.pointA;h.bodyA&&(f=h.pointB),e.beginPath(),e.arc(f.x,f.y,10,0,2*Math.PI),e.closePath(),e.stroke()}e.setLineDash([]),e.translate(-.5,-.5)}null!==t.selectStart&&(e.translate(.5,.5),e.lineWidth=1,e.strokeStyle="rgba(255,165,0,0.6)",e.fillStyle="rgba(255,165,0,0.1)",n=t.selectBounds,e.beginPath(),e.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),e.closePath(),e.stroke(),e.fill(),e.translate(-.5,-.5)),r.hasBounds&&e.setTransform(1,0,0,1,0,0)};var n=function(t,e){var n=t.engine,o=t.timing,r=o.historySize,s=n.timing.timestamp;o.delta=e-o.lastTime||i._goodDelta,o.lastTime=e,o.timestampElapsed=s-o.lastTimestamp||0,o.lastTimestamp=s,o.deltaHistory.unshift(o.delta),o.deltaHistory.length=Math.min(o.deltaHistory.length,r),o.engineDeltaHistory.unshift(n.timing.lastDelta),o.engineDeltaHistory.length=Math.min(o.engineDeltaHistory.length,r),o.timestampElapsedHistory.unshift(o.timestampElapsed),o.timestampElapsedHistory.length=Math.min(o.timestampElapsedHistory.length,r),o.engineElapsedHistory.unshift(n.timing.lastElapsed),o.engineElapsedHistory.length=Math.min(o.engineElapsedHistory.length,r),o.elapsedHistory.unshift(o.lastElapsed),o.elapsedHistory.length=Math.min(o.elapsedHistory.length,r)},u=function(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length||0},h=function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},f=function(t){var e=t.getContext("2d");return(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)},p=function(t,e){var n=t.textures[e];return n||((n=t.textures[e]=new Image).src=e,n)},d=function(t,e){var n=e;/(jpg|gif|png)$/.test(e)&&(n="url("+e+")"),t.canvas.style.background=n,t.canvas.style.backgroundSize="contain",t.currentBackground=e}}()},function(t,e){var n={};t.exports=n,n.create=function(t){return{vertex:t,normalImpulse:0,tangentImpulse:0}}},function(t,e,n){var i={};t.exports=i;var o=n(7),r=n(19),s=n(14),a=n(20),c=n(4),l=n(5),u=n(10),h=n(0),f=n(6);i.create=function(t){t=t||{};var e=h.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},t);return e.world=t.world||l.create({label:"World"}),e.pairs=t.pairs||a.create(),e.detector=t.detector||s.create(),e.grid={buckets:[]},e.world.gravity=e.gravity,e.broadphase=e.grid,e.metrics={},e},i.update=function(t,e,n){var f=h.now();e=e||1e3/60,n=n||1;var p,d=t.world,y=t.detector,g=t.pairs,m=t.timing,v=m.timestamp;m.timestamp+=e*m.timeScale,m.lastDelta=e*m.timeScale;var x={timestamp:m.timestamp};c.trigger(t,"beforeUpdate",x);var b=l.allBodies(d),w=l.allConstraints(d);for(d.isModified&&s.setBodies(y,b),d.isModified&&l.setModified(d,!1,!1,!0),t.enableSleeping&&o.update(b,m.timeScale),i._bodiesApplyGravity(b,t.gravity),i._bodiesUpdate(b,e,m.timeScale,n,d.bounds),u.preSolveAll(b),p=0;p<t.constraintIterations;p++)u.solveAll(w,m.timeScale);u.postSolveAll(b),y.pairs=t.pairs;var S=s.collisions(y);for(a.update(g,S,v),t.enableSleeping&&o.afterCollisions(g.list,m.timeScale),g.collisionStart.length>0&&c.trigger(t,"collisionStart",{pairs:g.collisionStart}),r.preSolvePosition(g.list),p=0;p<t.positionIterations;p++)r.solvePosition(g.list,m.timeScale);for(r.postSolvePosition(b),u.preSolveAll(b),p=0;p<t.constraintIterations;p++)u.solveAll(w,m.timeScale);for(u.postSolveAll(b),r.preSolveVelocity(g.list),p=0;p<t.velocityIterations;p++)r.solveVelocity(g.list,m.timeScale);return g.collisionActive.length>0&&c.trigger(t,"collisionActive",{pairs:g.collisionActive}),g.collisionEnd.length>0&&c.trigger(t,"collisionEnd",{pairs:g.collisionEnd}),i._bodiesClearForces(b),c.trigger(t,"afterUpdate",x),t.timing.lastElapsed=h.now()-f,t},i.merge=function(t,e){if(h.extend(t,e),e.world){t.world=e.world,i.clear(t);for(var n=l.allBodies(t.world),r=0;r<n.length;r++){var s=n[r];o.set(s,!1),s.id=h.nextId()}}},i.clear=function(t){a.clear(t.pairs),s.clear(t.detector)},i._bodiesClearForces=function(t){for(var e=0;e<t.length;e++){var n=t[e];n.force.x=0,n.force.y=0,n.torque=0}},i._bodiesApplyGravity=function(t,e){var n=void 0!==e.scale?e.scale:.001;if((0!==e.x||0!==e.y)&&0!==n)for(var i=0;i<t.length;i++){var o=t[i];o.isStatic||o.isSleeping||(o.force.y+=o.mass*e.y*n,o.force.x+=o.mass*e.x*n)}},i._bodiesUpdate=function(t,e,n,i,o){for(var r=0;r<t.length;r++){var s=t[r];s.isStatic||s.isSleeping||f.update(s,e,n,i)}}},function(t,e,n){var i={};t.exports=i;var o=n(3),r=n(1);i._restingThresh=4,i._restingThreshTangent=6,i._positionDampen=.9,i._positionWarming=.8,i._frictionNormalMultiplier=5,i.preSolvePosition=function(t){var e,n,i,o=t.length;for(e=0;e<o;e++)(n=t[e]).isActive&&(i=n.activeContacts.length,n.collision.parentA.totalContacts+=i,n.collision.parentB.totalContacts+=i)},i.solvePosition=function(t,e){var n,o,r,s,a,c,l,u,h=i._positionDampen,f=t.length;for(n=0;n<f;n++)(o=t[n]).isActive&&!o.isSensor&&(s=(r=o.collision).parentA,a=r.parentB,c=r.normal,o.separation=c.x*(a.positionImpulse.x+r.penetration.x-s.positionImpulse.x)+c.y*(a.positionImpulse.y+r.penetration.y-s.positionImpulse.y));for(n=0;n<f;n++)(o=t[n]).isActive&&!o.isSensor&&(s=(r=o.collision).parentA,a=r.parentB,c=r.normal,u=(o.separation-o.slop)*e,(s.isStatic||a.isStatic)&&(u*=2),s.isStatic||s.isSleeping||(l=h/s.totalContacts,s.positionImpulse.x+=c.x*u*l,s.positionImpulse.y+=c.y*u*l),a.isStatic||a.isSleeping||(l=h/a.totalContacts,a.positionImpulse.x-=c.x*u*l,a.positionImpulse.y-=c.y*u*l))},i.postSolvePosition=function(t){for(var e=i._positionWarming,n=t.length,s=o.translate,a=r.update,c=0;c<n;c++){var l=t[c],u=l.positionImpulse,h=u.x,f=u.y,p=l.velocity;if(l.totalContacts=0,0!==h||0!==f){for(var d=0;d<l.parts.length;d++){var y=l.parts[d];s(y.vertices,u),a(y.bounds,y.vertices,p),y.position.x+=h,y.position.y+=f}l.positionPrev.x+=h,l.positionPrev.y+=f,h*p.x+f*p.y<0?(u.x=0,u.y=0):(u.x*=e,u.y*=e)}}},i.preSolveVelocity=function(t){var e,n,i=t.length;for(e=0;e<i;e++){var o=t[e];if(o.isActive&&!o.isSensor){var r=o.activeContacts,s=r.length,a=o.collision,c=a.parentA,l=a.parentB,u=a.normal,h=a.tangent;for(n=0;n<s;n++){var f=r[n],p=f.vertex,d=f.normalImpulse,y=f.tangentImpulse;if(0!==d||0!==y){var g=u.x*d+h.x*y,m=u.y*d+h.y*y;c.isStatic||c.isSleeping||(c.positionPrev.x+=g*c.inverseMass,c.positionPrev.y+=m*c.inverseMass,c.anglePrev+=c.inverseInertia*((p.x-c.position.x)*m-(p.y-c.position.y)*g)),l.isStatic||l.isSleeping||(l.positionPrev.x-=g*l.inverseMass,l.positionPrev.y-=m*l.inverseMass,l.anglePrev-=l.inverseInertia*((p.x-l.position.x)*m-(p.y-l.position.y)*g))}}}}},i.solveVelocity=function(t,e){var n,o,r,s,a=e*e,c=i._restingThresh*a,l=i._frictionNormalMultiplier,u=i._restingThreshTangent*a,h=Number.MAX_VALUE,f=t.length;for(r=0;r<f;r++){var p=t[r];if(p.isActive&&!p.isSensor){var d=p.collision,y=d.parentA,g=d.parentB,m=y.velocity,v=g.velocity,x=d.normal.x,b=d.normal.y,w=d.tangent.x,S=d.tangent.y,A=p.activeContacts,B=A.length,k=1/B,E=y.inverseMass+g.inverseMass,C=p.friction*p.frictionStatic*l*a;for(m.x=y.position.x-y.positionPrev.x,m.y=y.position.y-y.positionPrev.y,v.x=g.position.x-g.positionPrev.x,v.y=g.position.y-g.positionPrev.y,y.angularVelocity=y.angle-y.anglePrev,g.angularVelocity=g.angle-g.anglePrev,s=0;s<B;s++){var P=A[s],_=P.vertex,I=_.x-y.position.x,R=_.y-y.position.y,T=_.x-g.position.x,M=_.y-g.position.y,O=m.x-R*y.angularVelocity,L=m.y+I*y.angularVelocity,N=O-(v.x-M*g.angularVelocity),U=L-(v.y+T*g.angularVelocity),j=x*N+b*U,D=w*N+S*U,F=p.separation+j,V=Math.min(F,1),q=(V=F<0?0:V)*C;D>q||-D>q?(o=D>0?D:-D,(n=p.friction*(D>0?1:-1)*a)<-o?n=-o:n>o&&(n=o)):(n=D,o=h);var H=I*b-R*x,W=T*b-M*x,$=k/(E+y.inverseInertia*H*H+g.inverseInertia*W*W),z=(1+p.restitution)*j*$;if(n*=$,j*j>c&&j<0)P.normalImpulse=0;else{var G=P.normalImpulse;P.normalImpulse+=z,P.normalImpulse=Math.min(P.normalImpulse,0),z=P.normalImpulse-G}if(D*D>u)P.tangentImpulse=0;else{var Y=P.tangentImpulse;P.tangentImpulse+=n,P.tangentImpulse<-o&&(P.tangentImpulse=-o),P.tangentImpulse>o&&(P.tangentImpulse=o),n=P.tangentImpulse-Y}var K=x*z+w*n,X=b*z+S*n;y.isStatic||y.isSleeping||(y.positionPrev.x+=K*y.inverseMass,y.positionPrev.y+=X*y.inverseMass,y.anglePrev+=(I*X-R*K)*y.inverseInertia),g.isStatic||g.isSleeping||(g.positionPrev.x-=K*g.inverseMass,g.positionPrev.y-=X*g.inverseMass,g.anglePrev-=(T*X-M*K)*g.inverseInertia)}}}}},function(t,e,n){var i={};t.exports=i;var o=n(9),r=n(0);i.create=function(t){return r.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},t)},i.update=function(t,e,n){var i,r,s,a,c=t.list,l=c.length,u=t.table,h=e.length,f=t.collisionStart,p=t.collisionEnd,d=t.collisionActive;for(f.length=0,p.length=0,d.length=0,a=0;a<l;a++)c[a].confirmedActive=!1;for(a=0;a<h;a++)(s=(i=e[a]).pair)?(s.isActive?d.push(s):f.push(s),o.update(s,i,n),s.confirmedActive=!0):(u[(s=o.create(i,n)).id]=s,f.push(s),c.push(s));var y=[];for(l=c.length,a=0;a<l;a++)(s=c[a]).confirmedActive||(o.setActive(s,!1,n),p.push(s),s.collision.bodyA.isSleeping||s.collision.bodyB.isSleeping||y.push(a));for(a=0;a<y.length;a++)s=c[r=y[a]-a],c.splice(r,1),delete u[s.id]},i.clear=function(t){return t.table={},t.list.length=0,t.collisionStart.length=0,t.collisionActive.length=0,t.collisionEnd.length=0,t}},function(t,e,n){var i=t.exports=n(22);i.Axes=n(11),i.Bodies=n(12),i.Body=n(6),i.Bounds=n(1),i.Collision=n(8),i.Common=n(0),i.Composite=n(5),i.Composites=n(23),i.Constraint=n(10),i.Contact=n(17),i.Detector=n(14),i.Engine=n(18),i.Events=n(4),i.Grid=n(24),i.Mouse=n(13),i.MouseConstraint=n(25),i.Pair=n(9),i.Pairs=n(20),i.Plugin=n(15),i.Query=n(26),i.Render=n(16),i.Resolver=n(19),i.Runner=n(27),i.SAT=n(28),i.Sleeping=n(7),i.Svg=n(29),i.Vector=n(2),i.Vertices=n(3),i.World=n(30),i.Engine.run=i.Runner.run,i.Common.deprecated(i.Engine,"run","Engine.run ➤ use Matter.Runner.run(engine) instead")},function(t,e,n){var i={};t.exports=i;var o=n(15),r=n(0);i.name="matter-js",i.version="0.18.0",i.uses=[],i.used=[],i.use=function(){o.use(i,Array.prototype.slice.call(arguments))},i.before=function(t,e){return t=t.replace(/^Matter./,""),r.chainPathBefore(i,t,e)},i.after=function(t,e){return t=t.replace(/^Matter./,""),r.chainPathAfter(i,t,e)}},function(t,e,n){var i={};t.exports=i;var o=n(5),r=n(10),s=n(0),a=n(6),c=n(12),l=s.deprecated;i.stack=function(t,e,n,i,r,s,c){for(var l,u=o.create({label:"Stack"}),h=t,f=e,p=0,d=0;d<i;d++){for(var y=0,g=0;g<n;g++){var m=c(h,f,g,d,l,p);if(m){var v=m.bounds.max.y-m.bounds.min.y,x=m.bounds.max.x-m.bounds.min.x;v>y&&(y=v),a.translate(m,{x:.5*x,y:.5*v}),h=m.bounds.max.x+r,o.addBody(u,m),l=m,p+=1}else h+=r}f+=y+s,h=t}return u},i.chain=function(t,e,n,i,a,c){for(var l=t.bodies,u=1;u<l.length;u++){var h=l[u-1],f=l[u],p=h.bounds.max.y-h.bounds.min.y,d=h.bounds.max.x-h.bounds.min.x,y=f.bounds.max.y-f.bounds.min.y,g={bodyA:h,pointA:{x:d*e,y:p*n},bodyB:f,pointB:{x:(f.bounds.max.x-f.bounds.min.x)*i,y:y*a}},m=s.extend(g,c);o.addConstraint(t,r.create(m))}return t.label+=" Chain",t},i.mesh=function(t,e,n,i,a){var c,l,u,h,f,p=t.bodies;for(c=0;c<n;c++){for(l=1;l<e;l++)u=p[l-1+c*e],h=p[l+c*e],o.addConstraint(t,r.create(s.extend({bodyA:u,bodyB:h},a)));if(c>0)for(l=0;l<e;l++)u=p[l+(c-1)*e],h=p[l+c*e],o.addConstraint(t,r.create(s.extend({bodyA:u,bodyB:h},a))),i&&l>0&&(f=p[l-1+(c-1)*e],o.addConstraint(t,r.create(s.extend({bodyA:f,bodyB:h},a)))),i&&l<e-1&&(f=p[l+1+(c-1)*e],o.addConstraint(t,r.create(s.extend({bodyA:f,bodyB:h},a))))}return t.label+=" Mesh",t},i.pyramid=function(t,e,n,o,r,s,c){return i.stack(t,e,n,o,r,s,(function(e,i,s,l,u,h){var f=Math.min(o,Math.ceil(n/2)),p=u?u.bounds.max.x-u.bounds.min.x:0;if(!(l>f||s<(l=f-l)||s>n-1-l))return 1===h&&a.translate(u,{x:(s+(n%2==1?1:-1))*p,y:0}),c(t+(u?s*p:0)+s*r,i,s,l,u,h)}))},i.newtonsCradle=function(t,e,n,i,s){for(var a=o.create({label:"Newtons Cradle"}),l=0;l<n;l++){var u=c.circle(t+l*(1.9*i),e+s,i,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),h=r.create({pointA:{x:t+l*(1.9*i),y:e},bodyB:u});o.addBody(a,u),o.addConstraint(a,h)}return a},l(i,"newtonsCradle","Composites.newtonsCradle ➤ moved to newtonsCradle example"),i.car=function(t,e,n,i,s){var l=a.nextGroup(!0),u=.5*-n+20,h=.5*n-20,f=o.create({label:"Car"}),p=c.rectangle(t,e,n,i,{collisionFilter:{group:l},chamfer:{radius:.5*i},density:2e-4}),d=c.circle(t+u,e+0,s,{collisionFilter:{group:l},friction:.8}),y=c.circle(t+h,e+0,s,{collisionFilter:{group:l},friction:.8}),g=r.create({bodyB:p,pointB:{x:u,y:0},bodyA:d,stiffness:1,length:0}),m=r.create({bodyB:p,pointB:{x:h,y:0},bodyA:y,stiffness:1,length:0});return o.addBody(f,p),o.addBody(f,d),o.addBody(f,y),o.addConstraint(f,g),o.addConstraint(f,m),f},l(i,"car","Composites.car ➤ moved to car example"),i.softBody=function(t,e,n,o,r,a,l,u,h,f){h=s.extend({inertia:1/0},h),f=s.extend({stiffness:.2,render:{type:"line",anchors:!1}},f);var p=i.stack(t,e,n,o,r,a,(function(t,e){return c.circle(t,e,u,h)}));return i.mesh(p,n,o,l,f),p.label="Soft Body",p},l(i,"softBody","Composites.softBody ➤ moved to softBody and cloth examples")},function(t,e,n){var i={};t.exports=i;var o=n(9),r=n(0),s=r.deprecated;i.create=function(t){return r.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},t)},i.update=function(t,e,n,o){var r,s,a,c,l,u=n.world,h=t.buckets,f=!1;for(r=0;r<e.length;r++){var p=e[r];if((!p.isSleeping||o)&&(!u.bounds||!(p.bounds.max.x<u.bounds.min.x||p.bounds.min.x>u.bounds.max.x||p.bounds.max.y<u.bounds.min.y||p.bounds.min.y>u.bounds.max.y))){var d=i._getRegion(t,p);if(!p.region||d.id!==p.region.id||o){p.region&&!o||(p.region=d);var y=i._regionUnion(d,p.region);for(s=y.startCol;s<=y.endCol;s++)for(a=y.startRow;a<=y.endRow;a++){c=h[l=i._getBucketId(s,a)];var g=s>=d.startCol&&s<=d.endCol&&a>=d.startRow&&a<=d.endRow,m=s>=p.region.startCol&&s<=p.region.endCol&&a>=p.region.startRow&&a<=p.region.endRow;!g&&m&&m&&c&&i._bucketRemoveBody(t,c,p),(p.region===d||g&&!m||o)&&(c||(c=i._createBucket(h,l)),i._bucketAddBody(t,c,p))}p.region=d,f=!0}}}f&&(t.pairsList=i._createActivePairsList(t))},s(i,"update","Grid.update ➤ replaced by Matter.Detector"),i.clear=function(t){t.buckets={},t.pairs={},t.pairsList=[]},s(i,"clear","Grid.clear ➤ replaced by Matter.Detector"),i._regionUnion=function(t,e){var n=Math.min(t.startCol,e.startCol),o=Math.max(t.endCol,e.endCol),r=Math.min(t.startRow,e.startRow),s=Math.max(t.endRow,e.endRow);return i._createRegion(n,o,r,s)},i._getRegion=function(t,e){var n=e.bounds,o=Math.floor(n.min.x/t.bucketWidth),r=Math.floor(n.max.x/t.bucketWidth),s=Math.floor(n.min.y/t.bucketHeight),a=Math.floor(n.max.y/t.bucketHeight);return i._createRegion(o,r,s,a)},i._createRegion=function(t,e,n,i){return{id:t+","+e+","+n+","+i,startCol:t,endCol:e,startRow:n,endRow:i}},i._getBucketId=function(t,e){return"C"+t+"R"+e},i._createBucket=function(t,e){return t[e]=[]},i._bucketAddBody=function(t,e,n){var i,r=t.pairs,s=o.id,a=e.length;for(i=0;i<a;i++){var c=e[i];if(!(n.id===c.id||n.isStatic&&c.isStatic)){var l=s(n,c),u=r[l];u?u[2]+=1:r[l]=[n,c,1]}}e.push(n)},i._bucketRemoveBody=function(t,e,n){var i,s=t.pairs,a=o.id;e.splice(r.indexOf(e,n),1);var c=e.length;for(i=0;i<c;i++){var l=s[a(n,e[i])];l&&(l[2]-=1)}},i._createActivePairsList=function(t){var e,n,i=t.pairs,o=r.keys(i),s=o.length,a=[];for(n=0;n<s;n++)(e=i[o[n]])[2]>0?a.push(e):delete i[o[n]];return a}},function(t,e,n){var i={};t.exports=i;var o=n(3),r=n(7),s=n(13),a=n(4),c=n(14),l=n(10),u=n(5),h=n(0),f=n(1);i.create=function(t,e){var n=(t?t.mouse:null)||(e?e.mouse:null);n||(t&&t.render&&t.render.canvas?n=s.create(t.render.canvas):e&&e.element?n=s.create(e.element):(n=s.create(),h.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:l.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},r=h.extend(o,e);return a.on(t,"beforeUpdate",(function(){var e=u.allBodies(t.world);i.update(r,e),i._triggerEvents(r)})),r},i.update=function(t,e){var n=t.mouse,i=t.constraint,s=t.body;if(0===n.button){if(i.bodyB)r.set(i.bodyB,!1),i.pointA=n.position;else for(var l=0;l<e.length;l++)if(s=e[l],f.contains(s.bounds,n.position)&&c.canCollide(s.collisionFilter,t.collisionFilter))for(var u=s.parts.length>1?1:0;u<s.parts.length;u++){var h=s.parts[u];if(o.contains(h.vertices,n.position)){i.pointA=n.position,i.bodyB=t.body=s,i.pointB={x:n.position.x-s.position.x,y:n.position.y-s.position.y},i.angleB=s.angle,r.set(s,!1),a.trigger(t,"startdrag",{mouse:n,body:s});break}}}else i.bodyB=t.body=null,i.pointB=null,s&&a.trigger(t,"enddrag",{mouse:n,body:s})},i._triggerEvents=function(t){var e=t.mouse,n=e.sourceEvents;n.mousemove&&a.trigger(t,"mousemove",{mouse:e}),n.mousedown&&a.trigger(t,"mousedown",{mouse:e}),n.mouseup&&a.trigger(t,"mouseup",{mouse:e}),s.clearSourceEvents(e)}},function(t,e,n){var i={};t.exports=i;var o=n(2),r=n(8),s=n(1),a=n(12),c=n(3);i.collides=function(t,e){for(var n=[],i=e.length,o=t.bounds,a=r.collides,c=s.overlaps,l=0;l<i;l++){var u=e[l],h=u.parts.length,f=1===h?0:1;if(c(u.bounds,o))for(var p=f;p<h;p++){var d=u.parts[p];if(c(d.bounds,o)){var y=a(d,t);if(y){n.push(y);break}}}}return n},i.ray=function(t,e,n,r){r=r||1e-100;for(var s=o.angle(e,n),c=o.magnitude(o.sub(e,n)),l=.5*(n.x+e.x),u=.5*(n.y+e.y),h=a.rectangle(l,u,c,r,{angle:s}),f=i.collides(h,t),p=0;p<f.length;p+=1){var d=f[p];d.body=d.bodyB=d.bodyA}return f},i.region=function(t,e,n){for(var i=[],o=0;o<t.length;o++){var r=t[o],a=s.overlaps(r.bounds,e);(a&&!n||!a&&n)&&i.push(r)}return i},i.point=function(t,e){for(var n=[],i=0;i<t.length;i++){var o=t[i];if(s.contains(o.bounds,e))for(var r=1===o.parts.length?0:1;r<o.parts.length;r++){var a=o.parts[r];if(s.contains(a.bounds,e)&&c.contains(a.vertices,e)){n.push(o);break}}}return n}},function(t,e,n){var i={};t.exports=i;var o,r,s,a=n(4),c=n(18),l=n(0);"undefined"!=typeof window&&(o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,r=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),o||(o=function(t){s=setTimeout((function(){t(l.now())}),1e3/60)},r=function(){clearTimeout(s)}),i.create=function(t){var e=l.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},t);return e.delta=e.delta||1e3/e.fps,e.deltaMin=e.deltaMin||1e3/e.fps,e.deltaMax=e.deltaMax||1e3/(.5*e.fps),e.fps=1e3/e.delta,e},i.run=function(t,e){return void 0!==t.positionIterations&&(e=t,t=i.create()),function n(r){t.frameRequestId=o(n),r&&t.enabled&&i.tick(t,e,r)}(),t},i.tick=function(t,e,n){var i,o=e.timing,r=1,s={timestamp:o.timestamp};a.trigger(t,"beforeTick",s),t.isFixed?i=t.delta:(i=n-t.timePrev||t.delta,t.timePrev=n,t.deltaHistory.push(i),t.deltaHistory=t.deltaHistory.slice(-t.deltaSampleSize),r=(i=(i=(i=Math.min.apply(null,t.deltaHistory))<t.deltaMin?t.deltaMin:i)>t.deltaMax?t.deltaMax:i)/t.delta,t.delta=i),0!==t.timeScalePrev&&(r*=o.timeScale/t.timeScalePrev),0===o.timeScale&&(r=0),t.timeScalePrev=o.timeScale,t.correction=r,t.frameCounter+=1,n-t.counterTimestamp>=1e3&&(t.fps=t.frameCounter*((n-t.counterTimestamp)/1e3),t.counterTimestamp=n,t.frameCounter=0),a.trigger(t,"tick",s),a.trigger(t,"beforeUpdate",s),c.update(e,i,r),a.trigger(t,"afterUpdate",s),a.trigger(t,"afterTick",s)},i.stop=function(t){r(t.frameRequestId)},i.start=function(t,e){i.run(t,e)}},function(t,e,n){var i={};t.exports=i;var o=n(8),r=n(0).deprecated;i.collides=function(t,e){return o.collides(t,e)},r(i,"collides","SAT.collides ➤ replaced by Collision.collides")},function(t,e,n){var i={};t.exports=i,n(1);var o=n(0);i.pathToVertices=function(t,e){"undefined"==typeof window||"SVGPathSeg"in window||o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,r,s,a,c,l,u,h,f,p,d,y=[],g=0,m=0,v=0;e=e||15;var x=function(t,e,n){var i=n%2==1&&n>1;if(!f||t!=f.x||e!=f.y){f&&i?(p=f.x,d=f.y):(p=0,d=0);var o={x:p+t,y:d+e};!i&&f||(f=o),y.push(o),m=p+t,v=d+e}},b=function(t){var e=t.pathSegTypeAsLetter.toUpperCase();if("Z"!==e){switch(e){case"M":case"L":case"T":case"C":case"S":case"Q":m=t.x,v=t.y;break;case"H":m=t.x;break;case"V":v=t.y}x(m,v,t.pathSegType)}};for(i._svgPathToAbsolute(t),s=t.getTotalLength(),l=[],n=0;n<t.pathSegList.numberOfItems;n+=1)l.push(t.pathSegList.getItem(n));for(u=l.concat();g<s;){if((c=l[t.getPathSegAtLength(g)])!=h){for(;u.length&&u[0]!=c;)b(u.shift());h=c}switch(c.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":a=t.getPointAtLength(g),x(a.x,a.y,0)}g+=e}for(n=0,r=u.length;n<r;++n)b(u[n]);return y},i._svgPathToAbsolute=function(t){for(var e,n,i,o,r,s,a=t.pathSegList,c=0,l=0,u=a.numberOfItems,h=0;h<u;++h){var f=a.getItem(h),p=f.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(p))"x"in f&&(c=f.x),"y"in f&&(l=f.y);else switch("x1"in f&&(i=c+f.x1),"x2"in f&&(r=c+f.x2),"y1"in f&&(o=l+f.y1),"y2"in f&&(s=l+f.y2),"x"in f&&(c+=f.x),"y"in f&&(l+=f.y),p){case"m":a.replaceItem(t.createSVGPathSegMovetoAbs(c,l),h);break;case"l":a.replaceItem(t.createSVGPathSegLinetoAbs(c,l),h);break;case"h":a.replaceItem(t.createSVGPathSegLinetoHorizontalAbs(c),h);break;case"v":a.replaceItem(t.createSVGPathSegLinetoVerticalAbs(l),h);break;case"c":a.replaceItem(t.createSVGPathSegCurvetoCubicAbs(c,l,i,o,r,s),h);break;case"s":a.replaceItem(t.createSVGPathSegCurvetoCubicSmoothAbs(c,l,r,s),h);break;case"q":a.replaceItem(t.createSVGPathSegCurvetoQuadraticAbs(c,l,i,o),h);break;case"t":a.replaceItem(t.createSVGPathSegCurvetoQuadraticSmoothAbs(c,l),h);break;case"a":a.replaceItem(t.createSVGPathSegArcAbs(c,l,f.r1,f.r2,f.angle,f.largeArcFlag,f.sweepFlag),h);break;case"z":case"Z":c=e,l=n}"M"!=p&&"m"!=p||(e=c,n=l)}}},function(t,e,n){var i={};t.exports=i;var o=n(5);n(0),i.create=o.create,i.add=o.add,i.remove=o.remove,i.clear=o.clear,i.addComposite=o.addComposite,i.addBody=o.addBody,i.addConstraint=o.addConstraint}])},Ie();Math.sqrt(.5),Math.PI,Math.PI,Math.PI,Math.PI,Math.PI,Math.PI,Math.PI,Math.PI;const Re={w:"up",s:"down",a:"left",d:"right",W:"up",S:"down",A:"left",D:"right",ArrowUp:"up",ArrowDown:"down",ArrowLeft:"left",ArrowRight:"right",Enter:"select"," ":"select"};new Set(Object.values(Re));function Te(t){return t in Re}const Me=421.875;var Oe={width:750,height:Me};const Le=document.getElementById("canvas"),Ne=Le.getContext("2d");if(null==Ne)throw new Error("No Canvas");const Ue=new class{take({key:t,value:e}){if(Te(t)){const n=Re[t];this.controls[n]=e}else console.warn("Uncontrolled key:",t)}constructor(){_e(this,"controls",{up:!1,down:!1,left:!1,right:!1,select:!1})}},je=new class{constructor(){_e(this,"shapes",new Map),_e(this,"debugLines",[]),_e(this,"debugCircles",[]),_e(this,"debugLabels",[])}},De=new class{constructor(){_e(this,"zoom",-2.2),_e(this,"scale",1),_e(this,"x",0),_e(this,"y",0)}};let Fe=Date.now();window.onclick=function(){const t=Date.now(),e=t-Fe;console.log("dt:",e),Fe=t,console.log("state:",je),console.log("camera:",De)},window.onkeydown=function(t){Ue.take({key:t.key,value:!0})},window.onkeyup=function(t){Ue.take({key:t.key,value:!1})},window.onwheel=function(t){De.zoom-=.001*t.deltaY};const Ve=Pe();Ve.on("socketId",(t=>{je.id=t})),Ve.on("updateClient",(t=>{je.torsoId=t.torsoId;const e=new Map;Object.values(t.shapes).forEach((t=>{const n=je.shapes.get(t.id);null==n?e.set(t.id,t):(n.x=t.x,n.y=t.y,n.render=t.render,n.vertices=t.vertices,n.deleted=!1,e.set(n.id,n))})),je.shapes=e,je.debugCircles=t.debugCircles,je.debugLines=t.debugLines,je.debugLabels=t.debugLabels;const n={id:je.id,controls:Ue.controls};Ve.emit("updateServer",n)}));const qe=function(){window.requestAnimationFrame(qe),function(){De.scale=.9*Math.exp(De.zoom);const t=De.scale*Le.height/100,e=De.scale*Le.height/100,n=Le.width/2,i=Le.height/2;Ne.setTransform(e,0,0,t,n,i)}();const t=Le.width/De.scale*100,e=Le.height/De.scale*100;Ne.fillStyle="#0E0E10",Ne.fillRect(-t/2,-e/2,t,e),Ne.fillStyle="#343434",Ne.fillRect(-Oe.width,-Oe.height,2*Oe.width,2*Oe.height),je.shapes.forEach((t=>{var e,n;if(Ne.strokeStyle=null!==(e=t.render.strokeStyle)&&void 0!==e?e:"black",Ne.fillStyle=null!==(n=t.render.fillStyle)&&void 0!==n?n:"black",Ne.beginPath(),null==t.circleRadius||0===t.circleRadius?(t.ivertices.forEach((t=>Ne.lineTo(t.x-De.x,t.y-De.y))),Ne.closePath()):Ne.arc(t.ix-De.x,t.iy-De.y,t.circleRadius,0,2*Math.PI),Ne.fill(),Ne.lineWidth=2,Ne.stroke(),null!=t.circleRadius&&t.circleRadius>0){console.log("shape.fillStyle:",t.render.fillStyle,Ne.fillStyle);const e=Ne.fillStyle.toUpperCase(),n=e.slice(1,3),i=e.slice(3,5),o=e.slice(5,7);Ne.fillStyle="white",Ne.textAlign="center",Ne.textBaseline="middle",Ne.font="10px sans",Ne.fillText(n,t.ix-De.x,t.iy-De.y-9),Ne.fillText(i,t.ix-De.x,t.iy-De.y+1),Ne.fillText(o,t.ix-De.x,t.iy-De.y+11)}})),je.debugCircles.forEach((t=>{Ne.fillStyle=t.color,Ne.beginPath(),Ne.arc(t.x-De.x,t.y-De.y,t.radius,0,2*Math.PI),Ne.fill()})),je.debugLines.forEach((t=>{Ne.strokeStyle=t.color,Ne.lineWidth=8,Ne.beginPath(),Ne.moveTo(t.start.x-De.x,t.start.y-De.y),Ne.lineTo(t.end.x-De.x,t.end.y-De.y),Ne.stroke()})),je.debugLabels.forEach((t=>{Ne.fillStyle=t.color,Ne.lineWidth=4,Ne.font="10px sans",Ne.fillText(t.text,t.x-De.x,t.y-De.y)}))};qe();const He=.6,We=.4;setInterval((function(){je.shapes.forEach((t=>{null!=t.circleRadius&&0!==t.circleRadius?(t.ix=He*t.x+We*t.ix,t.iy=He*t.y+We*t.iy):t.vertices.forEach(((e,n)=>{t.ivertices[n].x=He*e.x+We*t.ivertices[n].x,t.ivertices[n].y=He*e.y+We*t.ivertices[n].y})),t.id===je.torsoId&&(De.x=t.ix,De.y=t.iy)}))}),10)}();
//# sourceMappingURL=index.81f5aeb4.js.map
